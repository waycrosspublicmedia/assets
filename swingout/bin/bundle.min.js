!function t(e,i,s){function o(a,r){if(!i[a]){if(!e[a]){var h="function"==typeof require&&require;if(!r&&h)return h(a,!0);if(n)return n(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var p=i[a]={exports:{}};e[a][0].call(p.exports,function(t){var i=e[a][1][t];return o(i?i:t)},p,p.exports,t,e,i,s)}return i[a].exports}for(var n="function"==typeof require&&require,a=0;a<s.length;a++)o(s[a]);return o}({1:[function(t,e,i){e.exports=function(t){"string"==typeof t&&(t=[t]);for(var e=[].slice.call(arguments,1),i=[],s=0;s<t.length-1;s++)i.push(t[s],e[s]||"");return i.push(t[s]),i.join("")}},{}],2:[function(t,e,i){!function(t){var i=/iPhone/i,s=/iPod/i,o=/iPad/i,n=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,a=/Android/i,r=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,h=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,l=/Windows Phone/i,p=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,_=/BlackBerry/i,d=/BB10/i,c=/Opera Mini/i,u=/(CriOS|Chrome)(?=.*\bMobile\b)/i,m=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,f=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),y=function(t,e){return t.test(e)},g=function(t){var e=t||navigator.userAgent,g=e.split("[FBAN");if("undefined"!=typeof g[1]&&(e=g[0]),g=e.split("Twitter"),"undefined"!=typeof g[1]&&(e=g[0]),this.apple={phone:y(i,e),ipod:y(s,e),tablet:!y(i,e)&&y(o,e),device:y(i,e)||y(s,e)||y(o,e)},this.amazon={phone:y(r,e),tablet:!y(r,e)&&y(h,e),device:y(r,e)||y(h,e)},this.android={phone:y(r,e)||y(n,e),tablet:!y(r,e)&&!y(n,e)&&(y(h,e)||y(a,e)),device:y(r,e)||y(h,e)||y(n,e)||y(a,e)},this.windows={phone:y(l,e),tablet:y(p,e),device:y(l,e)||y(p,e)},this.other={blackberry:y(_,e),blackberry10:y(d,e),opera:y(c,e),firefox:y(m,e),chrome:y(u,e),device:y(_,e)||y(d,e)||y(c,e)||y(m,e)||y(u,e)},this.seven_inch=y(f,e),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},w=function(){var t=new g;return t.Class=g,t};"undefined"!=typeof e&&e.exports&&"undefined"==typeof window?e.exports=g:"undefined"!=typeof e&&e.exports&&"undefined"!=typeof window?e.exports=w():"function"==typeof define&&define.amd?define("isMobile",[],t.isMobile=w()):t.isMobile=w()}(this)},{}],3:[function(t,e,i){"use strict";function s(){}var o=t("./Common"),n=t("./scenes/SplashScene"),a=t("./scenes/CharacterSelectionScene"),r=t("./scenes/GameScene"),h=t("./overlays/PauseOverlay"),l=t("./overlays/GameoverOverlay"),p=t("./SavedData"),_=t("./game/WorldBackground");e.exports=s,s.prototype.init=function(){console.log("[Application] Init");var t=new PIXI.Graphics;t.beginFill(16777215),t.drawRect(0,0,2,2),o.generatedTextures.whiteSquare=o.renderer.generateTexture(t,1,PIXI.SCALE_MODES.LINEAR);var t=new PIXI.Graphics;t.beginFill(0),t.drawRect(0,0,2,2),o.generatedTextures.blackSquare=o.renderer.generateTexture(t,1,PIXI.SCALE_MODES.LINEAR),o.background=new _,o.stage.addChildAt(o.background,0),o.savedData=new p,o.savedData.init(),this.showSplashScene()},s.prototype.showSplashScene=function(t){var e=new n((!!t));e.signals.next.add(function(){this.showCharacterSelectionScene()},this);var i=new p3.Transition;o.sceneManager.add(e,i)},s.prototype.showCharacterSelectionScene=function(){var t=new a;t.signals.previous.add(function(){this.showSplashScene(!0)},this),t.signals.next.add(function(){this.showGameScene(!0)},this);var e=new p3.Transition;o.sceneManager.add(t,e)},s.prototype.showGameScene=function(t){var e=new r(t);e.signals.pause.add(function(t){this.showPauseOverlay(t)},this),e.signals.restart.add(function(){this.showGameScene()},this),e.signals.gameover.add(function(){this.showGameoverOverlay()},this);var i=new p3.Transition;o.sceneManager.add(e,i)},s.prototype.showPauseOverlay=function(t){var e=new h(t);e.signals.next.add(function(){o.sceneManager.remove()},this),e.signals.previous.add(function(){this.showSplashScene()},this);var i=new p3.Transition;i.replace=!1,i.push=!0,o.sceneManager.add(e,i)},s.prototype.showGameoverOverlay=function(){var t=new l;t.signals.next.add(function(){this.showGameScene()},this),t.signals.previous.add(function(){this.showSplashScene()},this);var e=new p3.Transition;e.replace=!1,e.push=!0,o.sceneManager.add(t,e)}},{"./Common":8,"./SavedData":10,"./game/WorldBackground":22,"./overlays/GameoverOverlay":25,"./overlays/PauseOverlay":26,"./scenes/CharacterSelectionScene":27,"./scenes/GameScene":28,"./scenes/SplashScene":30}],4:[function(t,e,i){"use strict";function s(){this.id=-1,this.howl=null}e.exports=s},{}],5:[function(t,e,i){"use strict";function s(){this._cache={},this._music=null,this._isMuted=!1;var t;"undefined"!=typeof document.hidden?(t="hidden",this.visibilityChange="visibilitychange"):"undefined"!=typeof document.mozHidden?(t="mozHidden",this.visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(t="msHidden",this.visibilityChange="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(t="webkitHidden",this.visibilityChange="webkitvisibilitychange"),document.addEventListener(this.visibilityChange,function(){document[t]?Howler.volume(0):Howler.volume(1)},!1)}var o=t("./Audio"),n=t("./AudioParams");e.exports=s,s.prototype.addSounds=function(t,e,i){i=i||"";var s,o,n,a,r,h,l;for(h=0;h<t.length;++h){for(n=i+t[h],n=n.split("/"),o=n[n.length-1],a=[],l=0;l<e.length;++l)r=e[l],a.push(n.join("/")+r);s=new Howl({src:a,volume:1,loop:!1,autoplay:!1}),s.name=o,this._cache[o]=s}},s.prototype.removeSounds=function(t){for(var e,i,s,o=0;o<t.length;++o){e=t[o];for(i in this._cache)if(this._cache.hasOwnProperty(key)&&(s=this._cache[key],s.name==i)){s.unload(),delete this._cache[e];break}}},s.prototype.playSound=function(t,e){e=e||new n;var i=-1;"string"!=typeof t&&(t=t[Math.floor(Math.random()*t.length)]);var s=this._cache[t];if(!s)return console.warn("Could not find sound - "+t),i;i=s.play(),s.volume(e.volume,i),s.loop(e.loop,i),s.__onend=function(){e.callback&&e.callback.call(e.scope)},s.on("end",s.__onend);var a=new o;return a.id=i,a.howl=s,a},s.prototype.playMusic=function(t,e){e=e||new n;var i=-1;if("string"!=typeof t&&(t=t[Math.floor(Math.random()*t.length)]),this._music&&this._music.name==t)return this._music;var s=this._cache[t];if(!s)return console.warn("Could not find music - "+t),null;s.__onend=function(){e.callback&&e.callback.call(e.scope)},s.on("end",s.__onend),p3.Device&&p3.Device.isAndroidStockBrowser&&(s.buffer=!0),i=s.play(),s.volume(e.volume,i),s.loop(!0,i);var a=new o;return a.id=i,a.howl=s,e.fadeIn>0&&this.fadeIn(a,e.fadeIn),this._music=a,a},s.prototype.stopSound=function(t,e){try{var i=this._cache[t];if(!i)return void console.warn("Could not find sound - "+t);i.stop(e)}catch(s){console.error(s)}},s.prototype.pauseSound=function(t,e){try{var i=this._cache[t];if(!i)return void console.warn("Could not find sound - "+t);i.pause(e)}catch(s){console.error(s)}},s.prototype.resumeSound=function(t,e){try{var i=this._cache[t];if(!i)return void console.warn("Could not find sound - "+t);i.play(e)}catch(s){console.error(s)}},s.prototype.fadeSound=function(t,e,i,s,o){try{var n=this._cache[t];if(!n)return void console.warn("Could not find sound - "+t);n.fade(i,s,1e3*o,e)}catch(a){console.error(a)}},s.prototype.stopMusic=function(t){if(this._music){var t=t||this._music.name;this._music.name==t&&(this._music.__onend&&this._music.off("end",this._music.__onend),this._music.howl.stop(),this._music=null)}},s.prototype.mute=function(t){this._isMuted=t,this._isMuted?Howler.mute(!0):Howler.mute(!1)},s.prototype.fadeIn=function(t,e,i,s){e=e||1;var o=t.howl.volume(t.id);t.howl.volume(0,t.id),t.__volume=0,TweenMax.killTweensOf(t),TweenMax.to(t,e,{__volume:o,ease:Power1.easeInOut,onUpdate:function(){t.howl.volume(t.__volume,t.id)},onUpdateScope:this,onComplete:i,onCompleteParams:[t],onCompleteScope:s})},s.prototype.fadeOut=function(t,e,i,s){e=e||1,t.__volume=t._volume,TweenMax.killTweensOf(t),TweenMax.to(t,e,{__volume:0,ease:Power1.easeInOut,onUpdate:function(){t.volume(t.__volume)},onUpdateScope:this,onComplete:i,onCompleteParams:[t],onCompleteScope:s})},s.prototype.setAudioPos3D=function(t,e,i,s,o){s=s||0,o=o||320;var n=i.findLayerForObject(e),a=e.x*(1/n.parallax.x),r=a-i.position.x;r/=Math.abs(r),r==-1?a=Math.min(0,(a+s-i.position.x)/(o-s)):1==r&&(a=Math.max(0,(a-s-i.position.x)/(o-s))),t.howl.pos(a,0,0,t.id)},s.prototype.setAudioPosStereo=function(t,e,i,s,o){s=s||0,o=o||320;var n=i.findLayerForObject(e),a=e.x*(1/n.parallax.x),r=a-i.position.x;r/=Math.abs(r),a=Math.max(0,Math.abs(a-s-i.position.x)/o),a=Math.max(0,Math.min(1,1+(1-a))),t.howl.volume(a,t.id),a=e.x*(1/n.parallax.x),r==-1?a=Math.min(0,(a+s-i.position.x)/(o-s)):1==r&&(a=Math.max(0,(a-s-i.position.x)/(o-s))),a=Math.max(-1,Math.min(1,a)),t.howl.stereo(a,t.id)},Object.defineProperty(s.prototype,"isMute",{get:function(){return this._isMuted}})},{"./Audio":4,"./AudioParams":6}],6:[function(t,e,i){"use strict";function s(){this.volume=1,this.loop=!1,this.delay=0,this.fadeIn=0,this.priority=0,this.callback=null,this.scope=window}e.exports=s},{}],7:[function(t,e,i){"use strict";function s(){var t=this.getSpec();t&&(this.height=t[0],window.addEventListener("resize",this.onResize.bind(this)),this.div=document.createElement("div"),this.div.style.backgroundColor="#000000",this.div.style.position="absolute",this.div.style.top="0",this.div.style.left="0",this.div.style.width="100%",this.div.style.height="9999999999999999px",this.image=new Image,this.image.src="brim.jpg",this.image.style.position="absolute",this.image.style.top="-35px",this.image.width=0,this.div.appendChild(this.image),this.brimMode=!0,document.body.appendChild(this.div),function(){var t;document.addEventListener("touchstart",function(e){this.brimMode&&(t=!0,e.preventDefault(),e.returnValue=!1)},!1),document.addEventListener("touchmove",function(e){this.brimMode&&(t&&(e.preventDefault(),e.returnValue=!1),t=!1)},!1)}(),this.onResize())}t("./Common");e.exports=s,s.prototype.getSpec=function(){for(var t=[[320,480,2,"iPhone 4"],[320,568,2,"iPhone 5 or 5s"],[375,667,2,"iPhone 6"],[414,736,3,"iPhone 6 plus"]],e=0;e<t.length;e++){var i=t[e],s=window.screen.height==i[0]&&window.screen.width==i[1]||window.screen.width==i[0]&&window.screen.height==i[1];if(s)return i}return null},s.prototype.showBrim=function(){this.div.style.visibility="visible",this.div.style.height="9999999999999999px"},s.prototype.showGame=function(){this.div.style.visibility="hidden",this.div.style.height=this.height+1+"px",window.scrollTo(0,0)},s.prototype.onResize=function(){window.innerHeight>window.innerWidth||window.innerHeight===this.height?this.showGame():this.showBrim(),this.image.width=window.innerWidth,window.scrollTo(0,0),window.setTimeout(function(){window.scrollTo(0,0)},1)}},{"./Common":8}],8:[function(t,e,i){"use strict";function s(){}e.exports=s,s.STAGE_WIDTH=1900,s.STAGE_HEIGHT=768,s.stage=null,s.renderer=null,s.timestep=null,s.animator=null,s.touch=new PIXI.Point(0,0),s.paused=!1,s.isWebGL=!1,s.DEBUG_PAINT_MODE=0,s.frameCount=0,s.FPS=60,s.sceneManager=null,s.generatedTextures={},s.COUNTRY_CODE="en",s.animationData={},s.savedData=null,s.bgMusic=null,s.bgMusicVolume=.5},{}],9:[function(t,e,i){"use strict";function s(t,e,i){this._width=t,this._height=e,this._language=i||"en",this._preloader=null,this._game=null,this._resolution=1,this._scale="hd/"}var o=t("./Application"),n=t("./AudioManager"),a=t("./Common"),r=t("./scenes/PreloaderScene"),h=t("ismobilejs");e.exports=s,s.prototype.init=function(){a.assets=p3.AssetManager.instance,a.audio=p3.Button.audio=new n;var t=new p3.ViewParams;t.holderId="game",t.width=this._width,t.height=this._height,t.rotateImageUrl="./rotate.jpg",t.rotateImageColor="#000000",p3.Device.init(window.bowser),TweenMax.defaultOverwrite="none",TweenMax.ticker.fps(60);var e=new p3.View(t);e.signals.ready.addOnce(function(e){var i={};i.view=e,i.transparent=!0,i.antialias=!1,i.preserveDrawingBuffer=!1,i.resolution=1;var s=new PIXI.Container;a.stage=s,p3.Device.isCocoonJS&&(s.scale.x=window.innerHeight/t.height,s.scale.y=window.innerHeight/t.height);var o=p3.Device.isCocoonJS?new PIXI.WebGLRenderer(window.innerWidth,window.innerHeight,i):PIXI.autoDetectRenderer(this._width,this._height,i);o.backgroundColor=0,a.renderer=o,a.isWebGL=o instanceof PIXI.WebGLRenderer;var n=new p3.SceneManager(o);a.sceneManager=n,a.stage.addChild(n.view);var r=new p3.Timestep(p3.Timestep.VARIABLE);r.init(this.update,this.render,this),a.timestep=r,a.animator=new p3.Animator,a.animator.init(),document.onclick=function(t){window.focus()},this.onCanvasResize(),this.loadPreloader()},this),e.signals.resize.add(this.onCanvasResize,this),window.addEventListener("resize",function(){this.onCanvasResize()}.bind(this),!1),a.view=e,p3.Device.isMobile||document.addEventListener("keydown",function(t){13==t.keyCode&&this.toggleFullScreen()}.bind(this),!1)},s.prototype.loadPreloader=function(){PIXI.settings.RETINA_PREFIX=/\_(?=[^_]*$)(.+)x/;var t=(this._scale,[{name:"strings",url:"data/localization.json"},{name:"preloader_0",url:"images/preloader_1x.json"},{name:"preloader_cn",url:"images/preloader_cn.json"},{name:"preloader_cn_bg",url:"images/preloader_cn_bg.jpg"},{name:"ui",url:"images/ui_1x.json"}]),e=[];if(t.length){a.assets.addFiles(t,"assets/"),a.assets.signals.complete.addOnce(function(){a.language=this._language,a.copy=a.assets.getJSON("strings").copy,a.liveFont="ar"==a.language?"FredFredburgerAra-Regular":"Junegull-Regular",this.loadAssets()},this),a.assets.load();var i=h.android.device?[".ogg"]:[".m4a",".mp3",".ogg"];a.audio.addSounds(e,i)}else this.loadAssets()},s.prototype.loadAssets=function(){var t=[{name:"text",url:"fonts/white.fnt"},{name:"text_yellow",url:"fonts/yellow.fnt"},{name:"text_orange",url:"fonts/orange.fnt"},{name:"text_green",url:"fonts/green.fnt"},{name:"text_rainbow",url:"fonts/rainbow.fnt"},{name:"config",url:"data/config.json"},{name:"game_assets",url:"images/game_assets_1x.json"},{name:"characters",url:"images/characters_1x.json"},{name:"endlevel_0",url:"images/endlevel_1x0.json"},{name:"endlevel_1",url:"images/endlevel_1x1.json"},{name:"void_1",url:"images/void_1.jpg"},{name:"title",url:"images/localisation/title_"+a.language+".png"},{name:"ps_gameover",url:"particles/ps_gameover_2.json"},{name:"ps_star_burst",url:"particles/ps_star_burst.json"},{name:"ps_perfect_score",url:"particles/ps_perfect_score.json"},{name:"ps_dust",url:"particles/ps_dust.json"},{name:"ps_char_switch",url:"particles/ps_char_switch.json"}],e=["sfx_btn_rollover_00","sfx_btn_press_00","sfx_impactfloor01","sfx_impactfloor02","sfx_impactfloor03","sfx_impactfloor04","sfx_impactfloor05","sfx_impactfloor06","sfx_rope_appear_00","sfx_rope_disappear_00","sfx_anais_perfect_00","sfx_anais_fail_00","sfx_anton_perfect_00","sfx_anton_fail_00","sfx_banana_perfect_00","sfx_banana_fail_00","sfx_carmen_perfect_00","sfx_carmen_fail_00","sfx_gumball_perfect_00","sfx_gumball_fail_00","sfx_darwin_perfect_00","sfx_darwin_fail_00","sfx_molly_perfect_00","sfx_molly_fail_00","sfx_tobias_perfect_00","sfx_tobias_fail_00","sfx_mrsmall_perfect_00","sfx_mrsmall_fail_00","sfx_boot_kick_00","sfx_character_choose_swipe_00","sfx_new_best_00","sfx_windchange_negative_01","sfx_windchange_positive_01","sfx_respawn_00","music_menuloop_00","music_gameloop_00","music_fail_02","music_bonusloop_00","music_perfect_landing_00"];this._preloader=new r,a.sceneManager.add(this._preloader),t.length?(a.assets.addFiles(t,"assets/"),a.assets.signals.progress.add(this.onLoadingProgress,this),a.assets.signals.complete.addOnce(this.onLoadingCompleted,this),a.assets.load(),a.audio.addSounds(e,[".mp3",".ogg"],"assets/audio/")):this.onLoadingCompleted()},s.prototype.startGame=function(){this._game=new o,this._game.init()},s.prototype.update=function(){a.sceneManager.update(),a.animator.update()},s.prototype.render=function(){a.renderer.render(a.stage)},s.prototype.onLoadingProgress=function(t){this._preloader.loaded=t.progress/200},s.prototype.onLoadingCompleted=function(t,e){e.text_image.texture.baseTexture.scaleMode=PIXI.SCALE_MODES.NEAREST,a.assets.signals.progress.removeAll(),a.assets.signals.complete.removeAll(),this._preloader.loaded=1,this._preloader.signals.next.add(function(){this.startGame()},this)},s.prototype.onCanvasResize=function(t){a.renderer&&a.renderer.resize(p3.View.width,p3.View.height),t&&a.sceneManager.resize()},s.prototype.toggleFullScreen=function(){}},{"./Application":3,"./AudioManager":5,"./Common":8,"./scenes/PreloaderScene":29,ismobilejs:2}],10:[function(t,e,i){"use strict";function s(){this.SAVE_NAME="gumball_swingout",this.SAVE_VERSION="0.0.0",this.SAVE_SEED="y5k0Eo6R177mUkb",this.lastScore=0,this.bestScore=0,this.character="gumball",this.tutorial=!1,this.gameMusic=0}t("./Common");e.exports=s,s.prototype.init=function(){window.localStorage[this.SAVE_NAME+"_"+this.SAVE_VERSION]?this.load():(this.reset(),this.save())},s.prototype.reset=function(){console.log("[Saved data] Reset")},s.prototype.load=function(){console.log("[Saved data] Load");var t=window.localStorage[this.SAVE_NAME+"_"+this.SAVE_VERSION];t=JSON.parse(t),this.lastScore=t.lastScore,this.bestScore=t.bestScore,this.character=t.character,this.tutorial=t.tutorial},s.prototype.save=function(){console.log("[Saved data] Save");var t={lastScore:this.lastScore,bestScore:this.bestScore,character:this.character,tutorial:this.tutorial},e=JSON.stringify(t);t.hash=md5(e+this.SAVE_SEED),window.localStorage[this.SAVE_NAME+"_"+this.SAVE_VERSION]=JSON.stringify(t)},s.prototype.recordScore=function(t){this.lastScore=t,this.bestScore=Math.max(this.lastScore,this.bestScore),this.save()}},{"./Common":8}],11:[function(t,e,i){"use strict";function s(){}var o=t("./Common");e.exports=s,s.FIRST_BUTTON_POSITION_H_MARGIN=84,s.getFirstButtonPositionRight=function(){return Math.min(Math.round(.5*(o.STAGE_WIDTH+p3.View.width)),o.STAGE_WIDTH-150)-s.FIRST_BUTTON_POSITION_H_MARGIN},s.getSecondButtonPositionRight=function(){return Math.min(Math.round(.5*(o.STAGE_WIDTH+p3.View.width)),o.STAGE_WIDTH-150)-2.4*s.FIRST_BUTTON_POSITION_H_MARGIN},s.getFirstButtonPositionLeft=function(){return Math.max(Math.round(.5*(o.STAGE_WIDTH-p3.View.width)),150)+s.FIRST_BUTTON_POSITION_H_MARGIN},s.getSecondButtonPositionLeft=function(){return Math.max(Math.round(.5*(o.STAGE_WIDTH-p3.View.width)),150)+2.4*s.FIRST_BUTTON_POSITION_H_MARGIN}},{"./Common":8}],12:[function(t,e,i){"use strict";function s(t,e){a.call(this,t),this._id=e,this._powerup={boot:0,life:0},this._animations=[],this._currentAnimation=null,this._multiplier=1,this._position=null}var o=t("../Common"),n=t("./EffectBoot"),a=t("./GameObject");e.exports=s,s.prototype=Object.create(a.prototype),s.prototype.constructor=s,s.prototype.init=function(){if(this._spriteContainer=new PIXI.Container,this._spriteContainer.scale.x=this._world.config.direction,this.addChild(this._spriteContainer),this._shape=new p2.Box({width:.8,height:1}),this._body=new p2.Body({mass:5,position:[0,2],fixedRotation:!0}),this._body.addShape(this._shape),this.changeAnimation("fall"),this._world.debug){var t=new PIXI.Sprite(o.generatedTextures.whiteSquare);t.anchor.set(.5,.5),t.width=this._shape.width*this._world.unitToPixel,t.height=this._shape.height*this._world.unitToPixel,t.tint=16711680,t.alpha=.25,this._spriteContainer.addChild(t)}this.position.x=this.body.position[0]*this._world.unitToPixel,this.position.y=-this.body.position[1]*this._world.unitToPixel},s.prototype.update=function(){this.position.x=this.body.interpolatedPosition[0]*this._world.unitToPixel,this.position.y=-this.body.interpolatedPosition[1]*this._world.unitToPixel},s.prototype.destroy=function(t){PIXI.Container.prototype.destroy.call(this,t),this._scoreTimeline&&this._scoreTimeline.kill(),this._walkTimeline&&this._walkTimeline.kill(),this._bootTimeline&&this._bootTimeline.kill(),this._boot&&this._boot.destroy()},s.prototype.showPoints=function(t,e,i,s){this._scoreText||(this._scoreContainer=new PIXI.Container,this._world.gameplayLayer.addChild(this._scoreContainer),this._scoreTextSpecial=new PIXI.extras.BitmapText("",{font:"42px Gumball Rainbow",tint:16777215,align:"center"}),this._scoreTextSpecial.anchor.set(.5),this._scoreContainer.addChild(this._scoreTextSpecial),this._scoreText=new PIXI.extras.BitmapText("",{font:"42px Gumball 8bit THICK",tint:16777215,align:"center"}),this._scoreText.anchor.set(.5),this._scoreContainer.addChild(this._scoreText),this._scoreMessage=new PIXI.extras.BitmapText("",{font:"36px Gumball 8bit THICK",tint:16777215,align:"center"}),this._scoreMessage.anchor.set(.5),this._scoreMessage.y=-60,this._scoreContainer.addChild(this._scoreMessage));var n="";i?n=o.copy.SCORE_PERFECT[o.language].text:t*e>10?n=o.copy.SCORE_GREAT[o.language].text:t>=7&&e<=1&&!s&&(n=o.copy.SCORE_NICE[o.language].text),this._scoreMessage.text=n;var a=t*e;this._scoreTextSpecial.text=a,this._scoreTextSpecial.visible=""!=n,this._scoreText.text=a,this._scoreText.visible=!this._scoreTextSpecial.visible,this._scoreContainer.visible=!0,this._scoreContainer.x=this.x,this._scoreContainer.y=this.y-50,this._scoreTimeline&&this._scoreTimeline.kill(),this._scoreTimeline=new TimelineMax({onCompleteScope:this,onComplete:function(){this._scoreContainer.visible=!1}}),this._scoreTimeline.to(this._scoreContainer,2,{y:this._scoreContainer.y-200,ease:Sine.easeOut},0),this._scoreTimeline.fromTo(this._scoreContainer.scale,.5,{x:0,y:0},{x:1,y:1,ease:Back.easeOut},0),this._scoreTimeline.fromTo(this._scoreContainer,2,{alpha:1},{alpha:0,ease:Sine.easeIn},0)},s.prototype.walkTo=function(t,e,i){var s=Math.abs(t-this.body.position[0]),o=this._world.config.avatar.walkSpeed,n=s/o;this._walkTimeline&&this._walkTimeline.kill(),this._walkTimeline=new TimelineMax({onCompleteScope:this,onComplete:function(){e.call(i)}}),this._walkTimeline.value=this.body.position[0],this._walkTimeline.to(this._walkTimeline,n,{value:t,ease:Sine.easeOut,onUpdateScope:this,onUpdate:function(){this.body.position[0]=this._walkTimeline.value}},0)},s.prototype.addPowerup=function(t,e){return e=e||1,this._powerup[t]+=e,this._powerup[t]},s.prototype.hasPower=function(t){return!!this._powerup[t]>0},s.prototype.resetPowerup=function(t){this._powerup[t]&&(this._powerup[t]--,this._world.signals.powerupUsed.dispatch(t,this._powerup[t]))},s.prototype.addMultiplier=function(t){return t=t||1,this._multiplier=t,this._multiplier},s.prototype.resetMultiplier=function(){this._multiplier=1},s.prototype.savePosition=function(){this._savePosition=[this.body.position[0],this.body.position[1]]},s.prototype.powerBoot=function(t){this._boot||(this._boot=new n(this._world),this.parent.addChild(this._boot)),this._boot.animate(this.x,this.y,t),this.body.setZeroForce(),this.body.velocity[0]=0,this.body.velocity[1]=0,this.body.applyImpulseLocal([t*this._world.config.avatar.powerBoot[0],this._world.config.avatar.powerBoot[1]])},s.prototype.powerBootUnmissable=function(t){this.body.collisionResponse=!1;var e=Math.sign(t.platformX-this.baseX);this._boot||(this._boot=new n(this._world),this.parent.addChild(this._boot)),this._boot.animate(this.x,this.y,e)},s.prototype.powerRespawn=function(){this.body.setZeroForce(),this.body.velocity[0]=0,this.body.velocity[1]=0,this.body.position[0]=this._savePosition[0],this.body.position[1]=this._savePosition[1],TweenMax.fromTo(this._spriteContainer,.2,{alpha:0},{alpha:1,ease:Sine.easeIn,delay:0,repeat:5},0)},s.prototype.changeCharacter=function(t){var e=this._id;this._id=t,this.changeAnimation(this._currentAnimation.replace(e+"_",""),this._animations[this._currentAnimation].looping)},s.prototype.changeAnimation=function(t,e){if(!this._world.config.characters[this._id].animations[t])return void console.error("Animation %s doesn't exist for %s",t,this._id);var i=this._id+"_"+t;if(i!=this._currentAnimation){if(!this._animations[i]){for(var s=new p3.MovieClipSequence,n=[],a=0;a<this._world.config.characters[this._id].animations[t].length;a++){var r=this._world.config.characters[this._id].sprite+this._world.config.characters[this._id].animations[t][a];n.push(o.assets.getTexture(r))}s.addTextures(n);var h=new p3.MovieClip(s);if(h.x=this.spritePos.x,h.y=this.spritePos.y,h.animationSpeed=this._world.config.characters[this._id].animationSpeed[t]||.5,"hang"==t||"hangbk"==t||"fall"==t){h.anchor=new PIXI.Point(.5,1);var l={x:0,y:0};l.x+=-this._world.config.characters[this._id].spritePos.x+this._world.config.characters[this._id].handPos.x,l.y-=this._world.config.characters[this._id].spritePos.y+this._world.config.characters[this._id].handPos.y,l.y-=this._shape.height*this._world.unitToPixel,h.x+=l.x,h.y+=l.y,h.anchor.x+=l.x/n[0].width,h.anchor.y+=l.y/n[0].height}else h.anchor=new PIXI.Point(.5,1);h.looping=e,h.scale.set(this.spriteScale),this._spriteContainer.addChildAt(h,0),this._animations[i]=h}this._currentAnimation&&(this._animations[this._currentAnimation].visible=!1),this._currentAnimation=i,this._animations[this._currentAnimation].visible=!0,this._animations[this._currentAnimation].rotation=0,this._animations[this._currentAnimation].gotoAndPlay(0)}},Object.defineProperty(s.prototype,"id",{get:function(){return this._id}}),Object.defineProperty(s.prototype,"body",{get:function(){return this._body}}),Object.defineProperty(s.prototype,"shape",{get:function(){return this._shape}}),Object.defineProperty(s.prototype,"isStill",{get:function(){var t=Math.sqrt(this.body.velocity[0]*this.body.velocity[0]+this.body.velocity[1]*this.body.velocity[1]);return t<.001}}),Object.defineProperty(s.prototype,"isFalling",{get:function(){return this.body.velocity[1]<0}}),Object.defineProperty(s.prototype,"isVerticallyStill",{get:function(){return Math.abs(this.body.velocity[1])<.001}}),Object.defineProperty(s.prototype,"baseX",{get:function(){return this.body.interpolatedPosition[0]*this._world.unitToPixel}}),Object.defineProperty(s.prototype,"baseY",{get:function(){return(-this.body.interpolatedPosition[1]+this._shape.height/2)*this._world.unitToPixel}}),Object.defineProperty(s.prototype,"baseWidth",{get:function(){return this._shape.width*this._world.unitToPixel}}),Object.defineProperty(s.prototype,"multiplier",{get:function(){return this._multiplier||1}}),Object.defineProperty(s.prototype,"spritePos",{get:function(){var t={x:this._world.config.characters[this._id].spritePos.x*this.spriteScale,y:this._world.config.characters[this._id].spritePos.y*this.spriteScale+this._shape.height/2*this._world.unitToPixel};return t}}),Object.defineProperty(s.prototype,"spriteScale",{get:function(){return this._world.config.characters[this._id].spriteScale||1}}),Object.defineProperty(s.prototype,"handPos",{get:function(){var t={x:this._world.config.characters[this._id].handPos.x,y:this._world.config.characters[this._id].handPos.y+this._shape.height/2*this._world.unitToPixel};return t}})},{"../Common":8,"./EffectBoot":15,"./GameObject":17}],13:[function(t,e,i){"use strict";function s(t,e,i){PIXI.Container.call(this),this._world=t,this._tower=e,this._id=i,this.init()}var o=t("../Common");e.exports=s,s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,s.prototype.init=function(){this._spriteContainer=new PIXI.Container,this._spriteContainer.scale.x=-this._world.config.direction,this.addChild(this._spriteContainer);var t=this._world.config.characters[this._id];this._sprite=new PIXI.Sprite(o.assets.getTexture(t.sprite+t.animations.idle[0])),this._sprite.anchor.set(.5,1),this._sprite.position.set(t.spritePos.x,t.spritePos.y),this._spriteContainer.addChild(this._sprite)},s.prototype.hide=function(){TweenMax.killTweensOf(this),TweenMax.to(this,.5,{alpha:0,ease:Sine.easeOut},0)},Object.defineProperty(s.prototype,"id",{get:function(){return this._id}})},{"../Common":8}],14:[function(t,e,i){"use strict";function s(t,e){PIXI.Container.call(this),this._world=t,this._sprite=e,this._speed=0,this._windSpeed=40,this._accelleration=.03,this.init()}var o=t("../Common");e.exports=s,s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,s.prototype.init=function(){this._spriteContainer=new PIXI.Container,this.addChild(this._spriteContainer),this._sprite=new PIXI.Sprite(o.assets.getTexture(this._sprite)),this._sprite.anchor.set(.5),this._spriteContainer.addChild(this._sprite)},s.prototype.update=function(){var t=this._world.wind*this._windSpeed*this.parent.parallax;this._speed+=(t-this._speed)*this._accelleration,this.x+=this._speed*p3.Timestep.deltaTime;var e=this.x+this.parent.x<-o.STAGE_WIDTH/2-300,i=this.x+this.parent.x>+o.STAGE_WIDTH/2+300;e?this.respawn(1):i&&this.respawn(-1)},s.prototype.destroy=function(t){PIXI.Container.prototype.destroy.call(this,t),this.floatingAnimation&&this.floatingAnimation.kill()},s.prototype.randomizeAnimation=function(){this._spriteContainer.rotation=p3.Utils.randomRange(0,2*Math.PI),this._spriteContainer.scale.set(p3.Utils.randomRange(.8,1)),this.floatingAnimation&&this.floatingAnimation.kill(),this.floatingAnimation=new TimelineMax,this.floatingAnimation.to(this._spriteContainer,p3.Utils.randomRange(3,10),{rotation:this._spriteContainer.rotation+2*Math.PI*(Math.random()<.5?-1:1),ease:Linear.easeNone,repeat:-1},0),this.floatingAnimation.to(this._spriteContainer,p3.Utils.randomRange(3,5),{x:p3.Utils.randomRange(-200,200)*this.parent.parallax,ease:Sine.easeInOut,yoyo:!0,repeat:-1},0),this.floatingAnimation.to(this._spriteContainer,p3.Utils.randomRange(3,5),{y:p3.Utils.randomRange(-100,100)*this.parent.parallax,ease:Sine.easeInOut,yoyo:!0,repeat:-1},0),this.floatingAnimation.fromTo(this._sprite,.5,{alpha:0},{alpha:1,ease:Sine.easeIn},0)},s.prototype.randomizePosition=function(){this.x=-this.parent.x+p3.Utils.randomRange(-o.STAGE_WIDTH/2-this._sprite.width,o.STAGE_WIDTH/2+this._sprite.width),this.y=-this.parent.y+p3.Utils.randomRange(-o.STAGE_HEIGHT/2-this._sprite.height/2,o.STAGE_HEIGHT/2+this._sprite.height/2),this.randomizeAnimation()},s.prototype.respawn=function(t){this.x=-this.parent.x+(o.STAGE_WIDTH/2+this._sprite.width/2)*t+this._sprite.width/2,this.y=-this.parent.y+p3.Utils.randomRange(-o.STAGE_HEIGHT/2+this._sprite.height,o.STAGE_HEIGHT+this._sprite.height),this.randomizeAnimation()}},{"../Common":8}],15:[function(t,e,i){"use strict";function s(t){PIXI.Container.call(this),this._world=t,this.init()}var o=t("../Common");e.exports=s,s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,s.prototype.init=function(){this.visible=!1,this._spriteContainer=new PIXI.Container,this.addChild(this._spriteContainer),this._sprite=new PIXI.Sprite(o.assets.getTexture("icon_boot")),this._sprite.anchor.set(1,0),this._spriteContainer.addChild(this._sprite)},s.prototype.animate=function(t,e,i){this.visible=!0,this.x=t,this.y=e-30,this.scale.x=i,this._starPS||(this._starPS=new PIXI.particles.Emitter(this.parent,[o.assets.getTexture("part_2")],o.assets.getJSON("ps_star_burst")),this._starPS.autoUpdate=!0),this._starPS.emit=!0,this._starPS.updateOwnerPos(t+45*i,e-25),this._starPS.resetPositionTracking(),this._bootTimeline&&this._bootTimeline.kill(),this._bootTimeline=new TimelineMax({onCompleteScope:this,onComplete:function(){this.visible=!1}});var s=.15,n=.25;this._bootTimeline.fromTo(this._spriteContainer,s,{x:-25},{x:25,ease:Sine.easeOut},0),this._bootTimeline.fromTo(this._spriteContainer,s,{rotation:Math.PI/4},{rotation:-Math.PI/3,ease:Sine.easeInOut},0),this._bootTimeline.fromTo(this._spriteContainer,s/2,{alpha:0},{alpha:1,ease:Sine.easeOut},0),this._bootTimeline.to(this._spriteContainer,n,{alpha:0,ease:Sine.easeIn},s)},s.prototype.destroy=function(t){PIXI.Container.prototype.destroy.call(this,t),this._bootTimeline&&this._bootTimeline.kill(),this._starPS&&this._starPS.destroy()}},{"../Common":8}],16:[function(t,e,i){"use strict";function s(t,e,i){PIXI.Container.call(this),this._world=t,this._sprite=e,this._disableRotation=i,this.init()}var o=t("../Common"),n=t("../shaders/GlitchFilter");e.exports=s,s.prototype=Object.create(PIXI.Container.prototype),
s.prototype.constructor=s,s.prototype.init=function(){this._spriteContainer=new PIXI.Container,this.addChild(this._spriteContainer),this._sprite=new PIXI.Sprite(o.assets.getTexture(this._sprite)),this._sprite.anchor.set(.5),this._spriteContainer.addChild(this._sprite),this.glitch(p3.Utils.randomRange(0,15))},s.prototype.update=function(){var t=this.x+this.parent.x<-o.STAGE_WIDTH/2,e=this.x+this.parent.x>+o.STAGE_WIDTH/2;(1==this._world.config.direction&&t||this._world.config.direction==-1&&e)&&this.respawn()},s.prototype.destroy=function(t){PIXI.Container.prototype.destroy.call(this,t),this.floatingAnimation&&this.floatingAnimation.kill(),this.glitchTimeline&&this.glitchTimeline.kill(),this._sprite.filters=null},s.prototype.randomizeAnimation=function(){this._disableRotation||(this._spriteContainer.rotation=p3.Utils.randomRange(0,2*Math.PI)),this._spriteContainer.scale.set(p3.Utils.randomRange(.8,1)),this.floatingAnimation&&this.floatingAnimation.kill(),this.floatingAnimation=new TimelineMax,this._disableRotation||this.floatingAnimation.to(this._spriteContainer,p3.Utils.randomRange(60,360),{rotation:this._spriteContainer.rotation+2*Math.PI*(Math.random()<.5?-1:1),ease:Linear.easeNone,repeat:-1},0),this.floatingAnimation.to(this._spriteContainer,p3.Utils.randomRange(5,15),{x:p3.Utils.randomRange(-150,150)*this.parent.parallax,ease:Sine.easeInOut,yoyo:!0,repeat:-1},0),this.floatingAnimation.to(this._spriteContainer,p3.Utils.randomRange(5,15),{y:p3.Utils.randomRange(-150,150)*this.parent.parallax,ease:Sine.easeInOut,yoyo:!0,repeat:-1},0),this.floatingAnimation.fromTo(this._sprite,.5,{alpha:0},{alpha:1,ease:Sine.easeIn},0)},s.prototype.randomizePosition=function(){this.x=-this.parent.x+p3.Utils.randomRange(-o.STAGE_WIDTH/2-this._sprite.width,o.STAGE_WIDTH/2+this._sprite.width),this.y=-this.parent.y+p3.Utils.randomRange(-o.STAGE_HEIGHT/2-this._sprite.height/2,o.STAGE_HEIGHT/2+this._sprite.height/2),this.randomizeAnimation()},s.prototype.respawn=function(){this.x=-this.parent.x+(o.STAGE_WIDTH/2+this._sprite.width/2)*this._world.config.direction+this._sprite.width/2,this.y=-this.parent.y+p3.Utils.randomRange(-o.STAGE_HEIGHT/2+this._sprite.height,o.STAGE_HEIGHT+this._sprite.height),this.randomizeAnimation()},s.prototype.glitch=function(t){return this.glitchTimeline&&this.glitchTimeline.kill(),t?void(this.glitchTimeline=new TimelineMax({delay:t,onStartScope:this,onStart:function(){this.glitch()}})):(this._glitchFilter||(this._glitchFilter=new n(this._sprite)),this.glitchTimeline=new TimelineMax({onCompleteScope:this,onComplete:function(){this._sprite.alpha=1,this._sprite.filters=null,this.glitch(p3.Utils.randomRange(10,15))}}),this._glitchFilter.uniforms.pixels=p3.Utils.randomRange(10,15),this._sprite.filters=[this._glitchFilter],void this.glitchTimeline.to(this._sprite,p3.Utils.randomRange(.2,.35),{alpha:p3.Utils.randomRange(.3,.8),ease:Sine.easeOut,repeat:p3.Utils.randomInt(1,1),yoyo:!0},0))}},{"../Common":8,"../shaders/GlitchFilter":32}],17:[function(t,e,i){"use strict";function s(t){PIXI.Container.call(this),this._world=t,this._sounds=[]}var o=t("../Common");e.exports=s,s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,s.prototype.init=function(){},s.prototype.destroy=function(t){this.stopSound(),PIXI.Container.prototype.destroy.call(this,t)},s.prototype.update=function(){},s.prototype.playSound=function(t,e){return this._sounds[t]=o.audio.playSound(t,e),this._sounds[t].playing=!0,this._sounds[t].volume=1,this._sounds[t]},s.prototype.playRandomSound=function(t,e){if(0==t.length)return!1;var i=t[p3.Utils.randomInt(0,t.length-1)];return this.playSound(i,e)},s.prototype.stopSound=function(t){for(var e in this._sounds)t&&t!=e||o.audio.stopSound(e,this._sounds[e].id)}},{"../Common":8}],18:[function(t,e,i){"use strict";function s(t,e,i){PIXI.Container.call(this),this._world=t,this._tower=e,this._data=i,this._points=0,this._multiplier=1,this._power=null,this.init()}var o=t("../Common");e.exports=s,s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,s.prototype.init=function(){switch(this._glow=new PIXI.Sprite(o.assets.getTexture("starburst")),this._glow.anchor.set(.5),this.addChild(this._glow),this._glowTimeline=new TimelineMax,this._glowTimeline.to(this._glow,5,{rotation:2*Math.PI,ease:Linear.easeNone,repeat:-1},0),this._glowTimeline.to(this._glow.scale,2.25,{x:.75,y:.75,ease:Sine.easeInOut,repeat:-1,yoyo:!0},0),this._glowTimeline.to(this._glow,3.66,{alpha:.5,ease:Sine.easeInOut,repeat:-1,yoyo:!0},0),this._data.type){case"points":this._points=this._data.value,this._text=new PIXI.extras.BitmapText("+"+this._data.value,{font:"42px Gumball 8bit THICK",tint:16777215,align:"center"}),this._text.anchor.set(.5),this.addChild(this._text);break;case"multiplier":this._multiplier=this._data.value,this._text=new PIXI.extras.BitmapText("x"+this._data.value,{font:"42px Gumball 8bit THICK",tint:16777215,align:"center"}),this._text.anchor.set(.5),this.addChild(this._text);break;case"boot":this._power=this._data.type,this._sprite=new PIXI.Sprite(o.assets.getTexture("icon_boot")),this._sprite.anchor.set(.5),this.addChild(this._sprite);break;case"life":this._power=this._data.type,this._sprite=new PIXI.Sprite(o.assets.getTexture("icon_floppydisk")),this._sprite.anchor.set(.5),this.addChild(this._sprite);break;default:console.error("Invalid power-up type %s",this._data.type),this._text=new PIXI.extras.BitmapText(this._data.type+"??",{font:"42px Gumball 8bit THICK",tint:16777215,align:"center"}),this._text.anchor.set(.5),this.addChild(this._text)}},s.prototype.destroy=function(t){PIXI.Container.prototype.destroy.call(this,t),this._glowTimeline&&this._glowTimeline.kill()},Object.defineProperty(s.prototype,"points",{get:function(){return this._points}}),Object.defineProperty(s.prototype,"multiplier",{get:function(){return this._multiplier}}),Object.defineProperty(s.prototype,"power",{get:function(){return this._power}})},{"../Common":8}],19:[function(t,e,i){"use strict";function s(t){PIXI.Container.call(this),this._world=t,this._target=null,this._length=0}var o=t("../Common");e.exports=s,s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,s.prototype.init=function(){this._sprite=new PIXI.Sprite(o.assets.getTexture("tile_rope")),this._sprite.anchor.set(.5,0),this.addChild(this._sprite),this.visible=!1},s.prototype.update=function(){this.updateSprite()},s.prototype.updateSprite=function(){if(this._target){var t=[this._target.body.interpolatedPosition[0]+this._target.handPos.x/this._world.unitToPixel*this._world.config.direction,this._target.body.interpolatedPosition[1]+this._target.handPos.y/this._world.unitToPixel],e=Math.sqrt(Math.pow(this._pivot.position[0]-t[0],2)+Math.pow(this._pivot.position[1]-t[1],2));this._sprite.height=e*this._world.unitToPixel;var i=-Math.PI/2+2*Math.PI-Math.atan2(t[1]-this._pivot.position[1],t[0]-this._pivot.position[0]);this._sprite.rotation=i}},s.prototype.attach=function(t,e){this._target=t,this._target.body.damping=0,this._pivot=new p2.Body({position:e}),this._world.p2world.addBody(this._pivot),this._constraint=new p2.DistanceConstraint(this._pivot,t.body),this._world.p2world.addConstraint(this._constraint),this.visible=!0,this._sprite.x=+this._pivot.position[0]*this._world.unitToPixel,this._sprite.y=-this._pivot.position[1]*this._world.unitToPixel,this.updateSprite();var i=o.assets.getJSON("config").avatar.push,s=p3.Utils.randomRange(i[0],i[1]);this._target.body.applyImpulseLocal([-this._world.config.direction*s,s])},s.prototype.release=function(){this._target.body.damping=this._world.config.avatar.dampening,this._world.p2world.removeBody(this._pivot),this._world.p2world.removeConstraint(this._constraint),this._target=null,this.visible=!1},s.prototype.canBeReleased=function(){var t=(2*Math.PI-Math.atan2(targetPosition[1]-this._pivot.position[1],targetPosition[0]-this._pivot.position[0]),this._target.body.interpolatedPosition[0]-this._pivot.position[0]);return t>-2*this._world.config.direction}},{"../Common":8}],20:[function(t,e,i){"use strict";function s(t,e,i){PIXI.Container.call(this),this._world=t,this._sprite=e,this._position=i,this._velocity={x:0,y:0},this._powerup=null,this.init()}var o=t("../Common"),n=t("./Powerup"),a=t("./Character");e.exports=s,s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,s.prototype.init=function(){this._spriteContainer=new PIXI.Container,this.addChild(this._spriteContainer),this._sprite=new PIXI.Sprite(o.assets.getTexture(this._sprite)),this._sprite.anchor.set(.5),this._sprite.scale.x=Math.random()>.5?-1:1,this._spriteContainer.addChild(this._sprite),this._shape=new p2.Box({width:(this._sprite.width+this._world.config.tower.spritePadding.x)/this._world.unitToPixel,height:(this._sprite.height+this._world.config.tower.spritePadding.y)/this._world.unitToPixel}),this._body=new p2.Body({mass:0,position:[this._position[0],this._position[1]-this._shape.height/2],fixedRotation:!0}),this._body.addShape(this._shape),this._world.debug&&(this._debugSprite=new PIXI.Sprite(o.generatedTextures.whiteSquare),this._debugSprite.anchor.set(.5),this._debugSprite.width=this._shape.width*this._world.unitToPixel,this._debugSprite.height=this._shape.height*this._world.unitToPixel,this._debugSprite.alpha=.25,this._spriteContainer.addChild(this._debugSprite)),this._flag=new PIXI.Sprite(o.assets.getTexture("flag")),this._flag.anchor.set(.5,1),this._flag.y=-this.platformHeight/2-5,this._flag.visible=!1,this._spriteContainer.addChild(this._flag),this.position.x=this.body.position[0]*this._world.unitToPixel,this.position.y=-this.body.position[1]*this._world.unitToPixel},s.prototype.update=function(){this.position.x=this.body.interpolatedPosition[0]*this._world.unitToPixel,this.position.y=-this.body.interpolatedPosition[1]*this._world.unitToPixel},s.prototype.destroy=function(t){PIXI.Container.prototype.destroy.call(this,t),this._timeline&&this._timeline.kill(),this._timelineMovement&&this._timelineMovement.kill(),TweenMax.killTweensOf(this._flag),this._powerup&&(this.removeChild(this._powerup),this._powerup.destroy())},s.prototype.animateIn=function(t,e){e=e||.9,this._timeline&&this._timeline.kill(),this._timeline=new TimelineMax({delay:t}),this._timeline.from(this._spriteContainer,e,{y:1e3,ease:Back.easeOut},0),this._timeline.from(this._spriteContainer,e,{alpha:0,ease:Quart.easeOut},0),this._powerup&&(this._timeline.from(this._powerup,1,{alpha:0,ease:Sine.easeOut},e/2),this._timeline.from(this._powerup,1,{y:this._powerup.y-20,ease:Sine.easeInOut,repeat:-1,yoyo:!0},0))},s.prototype.animateOut=function(t,e){this._timeline&&this._timeline.kill(),this._timeline=new TimelineMax({onComplete:t,onCompleteScope:e}),this._timeline.to(this._spriteContainer,.6,{y:1e3,ease:Back.easeIn},0),this._timeline.to(this._spriteContainer,.6,{alpha:0,ease:Quart.easeIn},0)},s.prototype.move=function(t,e,i){i=i||0,this._velocity.x=t*this._world.config.direction,this._timelineMovement=new TimelineMax({delay:i}),this._timelineMovement.to(this._velocity,e,{x:-this._velocity.x,ease:Sine.easeInOut,repeat:-1,yoyo:!0,onUpdateScope:this,onUpdate:function(){this.body.velocity[0]=this._velocity.x,this.body.velocity[1]=this._velocity.y}},0)},s.prototype.stop=function(){this._timelineMovement&&this._timelineMovement.kill(),this.body.velocity[0]=0},s.prototype.addPowerup=function(t){this._powerup=new n(this._world,this,t),this._powerup.y=-this.platformHeight/2-80,this._spriteContainer.addChild(this._powerup)},s.prototype.hidePowerup=function(){this._powerup&&(TweenMax.killTweensOf(this._powerup),TweenMax.to(this._powerup,.5,{alpha:0,ease:Sine.easeOut},0))},s.prototype.hasPowerup=function(){return!!this._powerup},s.prototype.addCharacter=function(t){this._character=new a(this._world,this,t),this._character.y=-this.platformHeight/2,this._spriteContainer.addChild(this._character)},s.prototype.hideCharacter=function(){this._character&&this._character.hide()},s.prototype.showFlag=function(t){t=t||0,this._flag.visible=!0,this._flag.scale.x=0!=t?Math.sign(t):1;var e=2.5-.4*Math.abs(t),i=-Math.PI/48+Math.PI/48*t,s=+Math.PI/48+Math.PI/48*t;TweenMax.fromTo(this._flag,e,{rotation:i},{rotation:s,ease:Sine.easeInOut,repeat:-1,yoyo:!0})},s.prototype.hideFlag=function(){TweenMax.killTweensOf(this._flag),TweenMax.to(this._flag,.5,{rotation:+Math.PI/2,ease:Back.easeIn,delay:0}),TweenMax.to(this._flag,.25,{alpha:0,ease:Sine.easeIn,delay:.25})},Object.defineProperty(s.prototype,"body",{get:function(){return this._body}}),Object.defineProperty(s.prototype,"shape",{get:function(){return this._shape}}),Object.defineProperty(s.prototype,"platformY",{get:function(){return(-this.body.position[1]-this._shape.height/2)*this._world.unitToPixel}}),Object.defineProperty(s.prototype,"platformX",{get:function(){return this.body.position[0]*this._world.unitToPixel}}),Object.defineProperty(s.prototype,"platformWidth",{get:function(){return this._shape.width*this._world.unitToPixel}}),Object.defineProperty(s.prototype,"platformHeight",{get:function(){return this._shape.height*this._world.unitToPixel}}),Object.defineProperty(s.prototype,"bonusPoints",{get:function(){return this._powerup?this._powerup.points:0}}),Object.defineProperty(s.prototype,"bonusMultiplier",{get:function(){return this._powerup?this._powerup.multiplier:1}}),Object.defineProperty(s.prototype,"bonusPower",{get:function(){return this._powerup?this._powerup.power:null}}),Object.defineProperty(s.prototype,"character",{get:function(){return this._character?this._character.id:null}})},{"../Common":8,"./Character":13,"./Powerup":18}],21:[function(t,e,i){"use strict";function s(){PIXI.Container.call(this),this.debug=!1,this.config=o.assets.getJSON("config"),this._deltaTime=0,this._deltaTimeScale=1,this._score=0,this._nTowers=-1,this._status="fall",this._statusTime=0,this._statusChange=null,this._userTouch=!1,this._wind=0,this._switchCountdown=this.config.avatar.switchChara,this.focusPoint=new PIXI.Point(.5,.5),this.focusPosition=new PIXI.Point(0,0),this.focusPointTween=null,this.focusObject=null,this.zoom=1,this.zoomTarget=1,this.zoomTween=null,this._isShake=!1,this._shakeTime=0,this._shakeTimeEnd=1,this._shakeStrength={x:10,y:10},this._shakeDelta={x:0,y:0},this._p2world=new p2.World({gravity:[0,this.config.world.gravity]}),this._p2world.defaultContactMaterial.friction=this.config.world.friction,this._p2world.defaultContactMaterial.restitution=0,this.signals={},this.signals.playerLanded=new signals.Signal,this.signals.playerDied=new signals.Signal,this.signals.windChanged=new signals.Signal,this.signals.powerupPicked=new signals.Signal,this.signals.powerupUsed=new signals.Signal,this.signals.multiplierPicked=new signals.Signal,this.signals.multiplierUsed=new signals.Signal,this.init()}var o=t("../Common"),n=t("./Avatar"),a=t("./Tower"),r=t("./Rope"),h=t("./WorldLayer");t("./WorldBackground");e.exports=s,s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,s.prototype.init=function(){this._layers=[],this.addObjectLayer(.1,["element_9"],!0),this.addObjectLayer(.12,["element_6"]),this.addObjectLayer(.15,["element_7"],!0),this.addObjectLayer(.2,["element_5"]),this.addObjectLayer(.25,["element_4"]),this.addObjectLayer(.3,["element_2"]),this.addObjectLayer(.35,["element_13"]),this.addObjectLayer(.4,["element_3"]),this.addObjectLayer(.45,["element_1"]),this.addDebrisLayer(.6,["tinyrock_1","tinyrock_2","tinyrock_3","tinyrock_4","tinyrock_5","tinyrock_6"]),this.addDebrisLayer(.7,["tinyrock_1","tinyrock_2","tinyrock_3","tinyrock_4","tinyrock_5","tinyrock_6"]),this.addDebrisLayer(.8,["tinyrock_1","tinyrock_2","tinyrock_3","tinyrock_4","tinyrock_5","tinyrock_6"]),this._layers.gameplay=new h(this),this.addChild(this._layers.gameplay),this._towersContainer=new PIXI.Container,this._layers.gameplay.addChild(this._towersContainer),this._avatar=new n(this,o.savedData.character),this._avatar.init(),this._avatar.body.velocity[1]=-10,this._p2world.addBody(this._avatar.body),this._layers.gameplay.addChild(this._avatar),this._rope=new r(this),this._rope.init(),this._layers.gameplay.addChild(this._rope),this.focusObject=new PIXI.Point,this._currTower=this.createTower(0,0,-7),this.showNextTower(),this.addDebrisLayer(1.05,["tinyrock_1","tinyrock_2","tinyrock_3","tinyrock_4","tinyrock_5","tinyrock_6"]),this.addObjectLayer(1.1,["element_8"]),this.addDebrisLayer(1.1,["artifact_3","artifact_5","artifact_6"]),this.addObjectLayer(1.17,["element_10"]),this.addDebrisLayer(1.2,["artifact_3","artifact_5","artifact_6"]),this.addObjectLayer(1.24,["element_14"]),this.addDebrisLayer(1.25,["artifact_1","artifact_2","artifact_4"]),this.addObjectLayer(1.3,["element_12"]),this.addDebrisLayer(1.35,["artifact_1","artifact_2","artifact_4"]),this.addObjectLayer(1.37,["element_11"]),this.updateCamera(!0)},s.prototype.update=function(){switch(this._deltaTime=p3.Timestep.deltaTime,this._p2world.step(1/60,this.deltaTime*this._deltaTimeScale,10),this._dustPS&&this._dustPS.updateOwnerPos(this._avatar.x,this._avatar.y),this._statusChange?(this._status=this._statusChange,this._statusChange=null,this._statusTime=0):this._statusTime+=this.deltaTime,this._status){case"wait":this._statusChange="swing",this._currTower.body.collisionResponse=!1;var t=this._nextTower.body.position[0]+(this._avatar.body.position[0]-this._nextTower.body.position[0])*(1-this.config.avatar.ropePivot),e=(-this._nextTower.platformY-(this._currTower.platformY-this._nextTower.platformY)/2)/this.unitToPixel;e+=o.STAGE_HEIGHT/2/this.zoom/this.unitToPixel,this._rope.attach(this._avatar,[t,e]),this._avatar.changeAnimation("hangbk",!1),this._avatar.playSound("sfx_rope_appear_00"),this._avatar.hangVelocity=0;break;case"swing":if(this._userTouch&&this._statusTime>1){this._rope.release(),this._statusChange="fall",this._nextTower.body.collisionResponse=!0;var i=this._avatar._animations[this._avatar._currentAnimation].rotation;this._avatar.changeAnimation("fall"),this._avatar.playSound("sfx_rope_disappear_00"),TweenMax.fromTo(this._avatar._animations[this._avatar._currentAnimation],1,{rotation:i},{rotation:0,ease:Sine.easeOut})}else{var i=this._avatar._animations[this._avatar._currentAnimation].rotation;this._avatar.body.velocity[0]>1?this._avatar.changeAnimation("hang"):this._avatar.body.velocity[0]<-1&&this._avatar.changeAnimation("hangbk"),this._avatar._animations[this._avatar._currentAnimation].rotation=i,this._avatar.hangVelocity=.95*this._avatar.hangVelocity+.05*this._avatar.body.velocity[0],this._avatar._animations[this._avatar._currentAnimation].rotation-=.2*this.deltaTime*this._avatar.hangVelocity}break;case"boot":0==this._statusTime&&(this._avatar.body.collisionResponse=!1,this._bootTimeline&&this._bootTimeline.kill(),this._bootTimeline=new TimelineMax({onUpdateScope:this,onUpdate:function(){var t=Math.sin(this._bootTimeline.value*Math.PI/2);this._bootTimeline.endPosition=[this._nextTower.body.position[0],this._nextTower.body.position[1]+this._nextTower.shape.height/2+this._avatar.shape.height/2+.1],this._avatar.body.position[0]=this._bootTimeline.startPosition[0]+(this._bootTimeline.endPosition[0]-this._bootTimeline.startPosition[0])*t,this._avatar.body.position[1]=this._bootTimeline.startPosition[1]+(this._bootTimeline.endPosition[1]-this._bootTimeline.startPosition[1])*t,this._avatar.body.position[1]+=5*Math.sin(this._bootTimeline.value*Math.PI),this._avatar.body.velocity[0]=0,this._avatar.body.velocity[1]=0},onCompleteScope:this,onComplete:function(){this._avatar.body.collisionResponse=!0,this._statusChange="fall"}}),this._bootTimeline.value=0,this._bootTimeline.startPosition=[this._avatar.body.position[0],this._avatar.body.position[1]],this._bootTimeline.to(this._bootTimeline,1,{value:1,ease:Linear.easeNone},0));break;case"fall":if(0==this._statusTime&&(this._fallFx=!1),this._avatar.baseY>this._nextTower.platformY+30&&this._avatar.isFalling){this._avatar.hasPower("boot")&&Math.abs(this._nextTower.body.position[0]-this._avatar.body.position[0]-this._nextTower.shape.width/2)<this.config.boot.distance?(this._avatar.powerBootUnmissable(this._nextTower),this._avatar.resetPowerup("boot"),this._avatar.changeAnimation("fall"),this._avatar.playSound("sfx_boot_kick_00"),this._statusChange="boot"):(this._statusChange="gameover",this._nextTower.body.collisionResponse=!1,this._avatar.playSound("sfx_"+this._avatar.id+"_fail_00"));break}!this._nextTower.body.collisionResponse&&this._avatar.isFalling&&(this._nextTower.body.collisionResponse=!0);var s=this._nTowers>=0?this._nextTower:this._currTower,n=Math.abs(this._avatar.baseY-s.platformY),a=Math.abs(this._avatar.baseX-s.platformX),r=n<=2&&a<(this._avatar.baseWidth+s.platformWidth)/2;if(!this._fallFx&&!this._avatar.isVerticallyStill&&r&&this._nextTower.body.collisionResponse&&(this._fallFx=!0,this.shake(.5,2,6),this.effectDust(),this._avatar.changeAnimation("land"),this._avatar.playRandomSound(["sfx_impactfloor01","sfx_impactfloor02","sfx_impactfloor03","sfx_impactfloor04","sfx_impactfloor05","sfx_impactfloor06"])),r&&(this._avatar.isStill||this._statusTime>5)){this._avatar.body.setZeroForce(),this._statusChange="walking",this._nTowers++;var h=this.config.timeMultiplier;if(this._deltaTimeScale=h.min+(h.max-h.min)*Math.min(this._nTowers/h.towers,1),this._nTowers>0){this.randomizeWind(),this._nextTower.stop(),this._nextTower.hidePowerup(),this._nextTower.hideCharacter(),this._nextTower.hideFlag(),this._nextTower.character&&(this._avatar.changeCharacter(this._nextTower.character),this.effectSwitchCharacter(.5*(this._nextTower.platformX+this._avatar.x),this._nextTower.platformY));for(var l=this._avatar.x-this._nextTower.platformX,p=Math.abs(l)/(this._nextTower.platformWidth/2),h=this.config.score,_=0;_<h.length;_++)if(h[_].percentage>=p){var d=h[_].score,c=this._nextTower.bonusPoints,u=this._avatar.multiplier,m=0==_;this.awardPoints(d,c,u,m),u>1&&(this._avatar.resetMultiplier(),this.signals.multiplierUsed.dispatch()),m&&(this.effectPerfectScore(),this._avatar.playSound("sfx_"+this._avatar.id+"_perfect_00"),o.bgMusic.howl.fade(o.bgMusicVolume,0,500,o.bgMusic.id),o.audio.playSound("music_perfect_landing_00",{volume:o.bgMusicVolume,callback:function(){o.bgMusic&&o.bgMusic.howl.fade(0,o.bgMusicVolume,500,o.bgMusic.id)}}));break}if(this._nextTower.bonusMultiplier>1)this._avatar.addMultiplier(this._nextTower.bonusMultiplier),this.signals.multiplierPicked.dispatch(this._nextTower.bonusMultiplier+"x");else if(this._nextTower.bonusPower){var f=this._avatar.addPowerup(this._nextTower.bonusPower);this.signals.powerupPicked.dispatch(this._nextTower.bonusPower,f)}this.hideCurrentTower(),this.showNextTower(),this._nextTower.body.collisionResponse=!1}}else r&&this._avatar.isVerticallyStill&&!this._avatar.isStill&&this._nTowers>=0?this._nextTower.stop():this._avatar.body.applyForceLocal([this._wind,0]);break;case"walking":if(0==this._statusTime&&(this._isWalking=!1),!this._isWalking&&this._statusTime>.2){this._isWalking=!0;var y=this._currTower.body.position[0]+(this._currTower.shape.width-this._avatar.shape.width)/2*this.config.direction;this._avatar.walkTo(y,function(){this._avatar.savePosition(),this._statusChange="wait"},this),this._avatar.changeAnimation("walk",!0)}break;case"gameover":this._statusTime>1&&(this._avatar.hasPower("life")?(this._currTower.body.collisionResponse=!0,this._nextTower.body.collisionResponse=!0,this._avatar.powerRespawn(),this._avatar.resetPowerup("life"),this._avatar.playSound("sfx_respawn_00"),this._statusChange="wait"):this.gameOver())}this._rope.update(),this._avatar.update(),this._currTower&&this._currTower.update(),this._nextTower&&this._nextTower.update(),this._userTouch=!1,this.updateCamera();for(var g in this._layers)this._layers[g].update()},s.prototype.destroy=function(t){PIXI.Container.prototype.destroy.call(this,t),this._avatar.destroy(),this._perfectPS&&this._perfectPS.destroy(),this._dustPS&&this._dustPS.destroy(),this._switchCharacterPS&&this._switchCharacterPS.destroy(),this._currTower&&this._currTower.destroy(),this._nextTower&&this._nextTower.destroy();for(var e in this._layers)this._layers[e].destroy();this._p2world.clear()},s.prototype.updateCamera=function(t){var e={x:this.focusPosition.x,y:this.focusPosition.y};if(this._isShake&&(this.x-=this._shakeDelta.x,this.y-=this._shakeDelta.y,this._shakeTime+=p3.Timestep.deltaTime,this._shakeTime>=this._shakeTimeEnd&&(this._shakeTime=0,this._shakeDelta.x=0,this._shakeDelta.y=0,this._isShake=!1)),this.focusObject)if(t)this.focusPosition.x=this.focusObject.x,this.focusPosition.y=this.focusObject.y;else{var i=new PIXI.Point(this.focusObject.x-this.focusPosition.x,this.focusObject.y-this.focusPosition.y);this.focusPosition.x+=.045*i.x,this.focusPosition.y+=.045*i.y}if(this.scale.x=this.zoom,this.scale.y=this.zoom,t)this.x=o.STAGE_WIDTH*this.focusPoint.x-this.focusPosition.x*this.zoom,this.y=o.STAGE_HEIGHT*this.focusPoint.y-this.focusPosition.y*this.zoom;else for(var s in this._layers)this._layers[s].move(e.x-this.focusPosition.x,e.y-this.focusPosition.y);this._isShake&&(this._shakeDelta.x=p3.Utils.randomInt(-1,1)*(this._shakeStrength.x*(1-this._shakeTime/this._shakeTimeEnd)),this._shakeDelta.y=p3.Utils.randomInt(-1,1)*(this._shakeStrength.y*(1-this._shakeTime/this._shakeTimeEnd)),this.x+=this._shakeDelta.x,this.y+=this._shakeDelta.y)},s.prototype.shake=function(t,e,i){this._isShake=!0,this._shakeTime=0,this._shakeTimeEnd=t,this._shakeStrength.x=e,this._shakeStrength.y=i},s.prototype.createTower=function(t,e,i){var s=this.config.tower.sprites[t][p3.Utils.randomInt(0,this.config.tower.sprites[t].length-1)],o=new a(this,s,[e,i]);return this._towersContainer.addChild(o),this._p2world.addBody(o.body),o},s.prototype.hideCurrentTower=function(){this._currTower.animateOut(function(){this._world.p2world.removeBody(this.body),this.parent.removeChild(this),this.destroy()},this._currTower),this._currTower=this._nextTower,this._nextTower=null},s.prototype.showNextTower=function(t){t=t||0;for(var e=0,i=this.config.tower.sprites.length-1,s=this.config.tower.difficulty.downgradeChance[0]+Math.min(1,Math.max(0,this._nTowers)/this.config.tower.difficulty.towers)*(this.config.tower.difficulty.downgradeChance[1]-this.config.tower.difficulty.downgradeChance[0]);e<i&&!(Math.random()>s);)e++;var o=this._currTower.body.position[0]+p3.Utils.randomRange(this.config.tower.distance.x[0],this.config.tower.distance.x[1])*this.config.direction,n=this._currTower.body.position[1]+this._currTower.shape.height/2+p3.Utils.randomRange(this.config.tower.distance.y[0],this.config.tower.distance.y[1]);this.windStrength<0&&(o+=.5*this.windStrength),this._nextTower=this.createTower(e,o,n);for(var a=this.config.powerup,r=(this._nTowers+1)%(a[a.length-1].index+1),h=0;h<a.length;h++)if(a[h].index==r){"life"!=a[h].data.type&&"boot"!=a[h].data.type||!this._avatar.hasPower(a[h].data.type)?this._nextTower.addPowerup(a[h].data):this._nextTower.addPowerup({type:"points",value:15});break}if(this._switchCountdown--,this._switchCountdown<=0&&!this._nextTower.hasPowerup()){this._switchCountdown=this.config.avatar.switchChara;var l=[];for(var p in this.config.characters)p!=this._avatar.id&&l.push(p);if(l.length>0){var _=l[p3.Utils.randomInt(0,l.length-1)];this._nextTower.addCharacter(_)}}if(this._nextTower.showFlag(this.windStrength),this._nextTower.animateIn(t,.9),this._nTowers>=this.config.tower.movement.towers[0]&&Math.random()>this.config.tower.movement.probability){var d=Math.min(1,(this._nTowers-this.config.tower.movement.towers[0])/(this.config.tower.movement.towers[1]-this.config.tower.movement.towers[0])),c=this.config.tower.movement.speedMin[0]+(this.config.tower.movement.speedMin[1]-this.config.tower.movement.speedMin[0])*d,u=this.config.tower.movement.speedMax[0]+(this.config.tower.movement.speedMax[1]-this.config.tower.movement.speedMax[0])*d,o=p3.Utils.randomRange(c,u),m=p3.Utils.randomRange(this.config.tower.movement.time[0],this.config.tower.movement.time[1]);this._nextTower.move(o,m,t+.9),console.info("Tower moving by %f in %f seconds",o,m)}this.focusObject.x=this._nextTower.x+(this._currTower.x-this._nextTower.x)/2,this.focusObject.y=this._nextTower.platformY+(this._currTower.platformY-this._nextTower.platformY)/2},s.prototype.addObjectLayer=function(t,e,i){var s="objects_"+t;if(this._layers[s])var o=this._layers[s];else{var o=new h(this,t);this._layers[s]=o,this.addChild(o)}for(var n=0;n<e.length;n++)o.addFloatingObject(e[n],i)},s.prototype.addDebrisLayer=function(t,e){var i="dust_"+t;if(this._layers[i])var s=this._layers[i];else{var s=new h(this,t);this._layers[i]=s,this.addChild(s)}for(var o=0;o<e.length;o++)s.addDebrisObject(e[o])},s.prototype.awardPoints=function(t,e,i,s){console.info("(%i+%i)x%i points",t,e,i),this._score+=(t+e)*i,this._avatar.showPoints(t+e,i,s,e),this.signals.playerLanded.dispatch(this._score)},s.prototype.randomizeWind=function(){var t=this.config.wind;if(this._nTowers%t.changeFrequency==0){if(t.range[0]>=t.range[1]){console.error("Invalid wind range");var e=t.range[0],i=e*t.rangeForce}else do var e=p3.Utils.randomInt(t.range[0],t.range[1]),i=e*t.rangeForce;while(i==this._wind);this._wind=i,this.signals.windChanged.dispatch(e)}},s.prototype.gameOver=function(){console.info("Game over: %i points",this._score),this.signals.playerDied.dispatch(this._score)},s.prototype.userEvent=function(){this._userTouch=!0},s.prototype.effectPerfectScore=function(){this._perfectPS||(this._perfectPS=new PIXI.particles.Emitter(this._avatar.parent,[o.assets.getTexture("part_1"),o.assets.getTexture("part_2"),o.assets.getTexture("part_3"),o.assets.getTexture("part_4")],o.assets.getJSON("ps_perfect_score")),this._perfectPS.autoUpdate=!0),this._perfectPS.emit=!0,this._perfectPS.updateOwnerPos(this._avatar.x,this._avatar.y-60),this._perfectPS.resetPositionTracking()},s.prototype.effectDust=function(){this._dustPS||(this._dustPS=new PIXI.particles.Emitter(this._avatar.parent,[o.assets.getTexture("part_smoke_white"),o.assets.getTexture("part_smoke_grey")],o.assets.getJSON("ps_dust")),this._dustPS.autoUpdate=!0),this._dustPS.emit=!0,this._dustPS.updateOwnerPos(this._avatar.x,this._avatar.y),this._dustPS.resetPositionTracking()},s.prototype.effectSwitchCharacter=function(t,e){this._switchCharacterPS||(this._switchCharacterPS=new PIXI.particles.Emitter(this._avatar.parent,[o.assets.getTexture("part_smoke_white"),o.assets.getTexture("part_smoke_grey"),o.assets.getTexture("part_2")],o.assets.getJSON("ps_char_switch")),this._switchCharacterPS.autoUpdate=!0),this._switchCharacterPS.emit=!0,this._switchCharacterPS.updateOwnerPos(t,e),this._switchCharacterPS.resetPositionTracking()},Object.defineProperty(s.prototype,"deltaTime",{get:function(){return this._deltaTime*this._deltaTimeScale}}),Object.defineProperty(s.prototype,"p2world",{get:function(){return this._p2world}}),Object.defineProperty(s.prototype,"unitToPixel",{get:function(){return 50}}),Object.defineProperty(s.prototype,"gameplayLayer",{get:function(){return this._layers.gameplay}}),Object.defineProperty(s.prototype,"wind",{get:function(){return this._wind}}),Object.defineProperty(s.prototype,"windStrength",{get:function(){return this._wind/this.config.wind.rangeForce}})},{"../Common":8,"./Avatar":12,"./Rope":19,"./Tower":20,"./WorldBackground":22,"./WorldLayer":23}],22:[function(t,e,i){"use strict";function s(){PIXI.Container.call(this),this._time=0,this.init()}var o=t("../Common"),n=t("../shaders/BackgroundFilter");e.exports=s,s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,s.prototype.init=function(){var t=o.assets.getTexture("void_1");this._sprite=new PIXI.extras.TilingSprite(t,t.width,t.height),this.addChild(this._sprite),this.animation=new TimelineMax,this.animation.to(this._sprite.tilePosition,120,{y:-t.height,ease:Linear.easeNone,repeat:-1},0),this._backgroundFilter=new n,this._sprite.filters=[this._backgroundFilter],this.glitch(p3.Utils.randomRange(0,1)),PIXI.ticker.shared.add(this.update,this)},s.prototype.destroy=function(t){PIXI.Container.prototype.destroy.call(this,t),this.glitchTimeline&&this.glitchTimeline.kill(),
this._sprite.filters=null,PIXI.ticker.shared.remove(this.update,this)},s.prototype.update=function(t){this._backgroundFilter.uniforms.time+=t/60,this.x=.5*(p3.View.width-o.STAGE_WIDTH)},s.prototype.glitch=function(t){if(this.glitchTimeline&&this.glitchTimeline.kill(),t)return void(this.glitchTimeline=new TimelineMax({delay:t,onStartScope:this,onStart:function(){this.glitch()}}));this.glitchTimeline=new TimelineMax({delay:p3.Utils.randomRange(.1,.2),onCompleteScope:this,onComplete:function(){this._backgroundFilter.uniforms.bandCoords=[0,0],this.glitch(p3.Utils.randomRange(0,3))}});var e=p3.Utils.randomRange(0,.07),i=p3.Utils.randomRange(0,1-e);this._backgroundFilter.uniforms.bandCoords=[i,i+e],this._backgroundFilter.uniforms.bandColor=[p3.Utils.randomRange(-.1,.1),p3.Utils.randomRange(-.1,.1),p3.Utils.randomRange(-.1,.1)]},s.prototype.showObjects=function(){this._objects||(this._objects=new PIXI.Container,this._objects.alpha=0,this.addFloatingObject(.25,.75,.15,"element_9",!0),this.addFloatingObject(.3,.85,.85,"element_6"),this.addFloatingObject(.4,.25,.22,"element_7",!0),this.addFloatingObject(.5,.45,.75,"element_5"),this.addFloatingObject(.6,.3,.6,"element_4"),this.addFloatingObject(.7,.8,.35,"element_2"),this.addFloatingObject(.85,.7,.55,"element_13"),this.addFloatingObject(1,.2,.8,"element_3")),this.addChild(this._objects),TweenMax.killTweensOf(this._objects),TweenMax.to(this._objects,.5,{alpha:1,ease:Linear.easeNone},0)},s.prototype.hideObjects=function(){this._objects&&(TweenMax.killTweensOf(this._objects),TweenMax.to(this._objects,.5,{alpha:0,ease:Linear.easeNone,onCompleteScope:this,onComplete:function(){this.removeChild(this._objects)}},0))},s.prototype.addFloatingObject=function(t,e,i,s,n){var a=new PIXI.Container;this._objects.addChild(a);var s=new PIXI.Sprite(o.assets.getTexture(s));s.anchor.set(.5),a.addChild(s),n||(s.rotation=p3.Utils.randomRange(0,2*Math.PI)),a.x=e*o.STAGE_WIDTH,a.y=i*o.STAGE_HEIGHT,a.animation=new TimelineMax,n||a.animation.to(s,p3.Utils.randomRange(60,360),{rotation:s.rotation+2*Math.PI*(Math.random()<.5?-1:1),ease:Linear.easeNone,repeat:-1},0),a.animation.to(s,p3.Utils.randomRange(5,15),{x:p3.Utils.randomRange(-150,150)*t,ease:Sine.easeInOut,yoyo:!0,repeat:-1},0),a.animation.to(s,p3.Utils.randomRange(5,15),{y:p3.Utils.randomRange(-150,150)*t,ease:Sine.easeInOut,yoyo:!0,repeat:-1},0),a.animation.fromTo(s,.5,{alpha:0},{alpha:1,ease:Sine.easeIn},0)}},{"../Common":8,"../shaders/BackgroundFilter":31}],23:[function(t,e,i){"use strict";function s(t,e){PIXI.Container.call(this),this._world=t,this._parallax=e||1,this._objects=[],this._debrises=[]}var o=(t("../Common"),t("./FloatingObject")),n=t("./DebrisObject");e.exports=s,s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,s.prototype.update=function(){for(var t=0;t<this._objects.length;t++)this._objects[t].update();for(var t=0;t<this._debrises.length;t++)this._debrises[t].update()},s.prototype.destroy=function(t){PIXI.Container.prototype.destroy.call(this,t);for(var e=0;e<this._objects.length;e++)this._objects[e].destroy();for(var e=0;e<this._debrises.length;e++)this._debrises[e].destroy()},s.prototype.move=function(t,e){this.x+=t*this._parallax,this.y+=e*this._parallax},s.prototype.addFloatingObject=function(t,e){var i=new o(this._world,t,e);this._objects.push(i),this.addChild(i),i.randomizePosition(),this._parallax>1&&(i.alpha=1-(this._parallax-1)/2)},s.prototype.addDebrisObject=function(t){var e=new n(this._world,t);this._debrises.push(e),this.addChild(e),e.randomizePosition(),this._parallax>1&&(e.alpha=1-(this._parallax-1)/2)},Object.defineProperty(s.prototype,"parallax",{get:function(){return this._parallax}})},{"../Common":8,"./DebrisObject":14,"./FloatingObject":16}],24:[function(t,e,i){(function(e){"use strict";var i=t("./Main");e.Main=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Main":9}],25:[function(t,e,i){"use strict";function s(){p3.Scene.call(this),this.alpha=0}var o=t("../Common"),n=t("../Utils");t("../ui/MuteButton");e.exports=s,s.prototype=Object.create(p3.Scene.prototype),s.prototype.constructor=s,s.prototype.init=function(){this._overlay=new PIXI.Sprite(o.generatedTextures.whiteSquare),this._overlay.tint=0,this._overlay.width=o.STAGE_WIDTH,this._overlay.height=o.STAGE_HEIGHT,this._overlay.alpha=.75,this._overlay.interactive=!0,this.addChild(this._overlay),this._box=new PIXI.Sprite(o.assets.getTexture("panel_01")),this._box.anchor.set(.5),this._box.x=o.STAGE_WIDTH/2,this._box.y=o.STAGE_HEIGHT/2,this.addChild(this._box),this._psContainer=new PIXI.Container,this._psContainer.y=-120,this._box.addChild(this._psContainer),this._gameoverPS=new PIXI.particles.Emitter(this._psContainer,[o.assets.getTexture("part_1"),o.assets.getTexture("part_2"),o.assets.getTexture("part_3"),o.assets.getTexture("part_4")],o.assets.getJSON("ps_gameover")),this._gameoverPS.emit=!1,this._gameoverPS.autoUpdate=!0;var t=o.copy[o.savedData.lastScore>0?"WELL_DONE":"TRY_AGAIN"][o.language];t.live?this._title=new PIXI.Text(t.text,{fontFamily:o.liveFont,fontSize:"56px",fill:16776960,align:"center",stroke:0,strokeThickness:6,padding:20,lineJoin:"round"}):this._title=new PIXI.extras.BitmapText(t.text,{font:"56px Gumball Yellow",tint:16777215,align:"center"}),this._title.anchor.set(.5),this._title.y=-200,this._box.addChild(this._title),this._score=new PIXI.extras.BitmapText(o.savedData.lastScore.toString(),{font:"100px Gumball Rainbow",tint:16777215,align:"center"}),this._score.anchor.set(.5),this._score.y=-65,this._box.addChild(this._score);var t=o.copy.BEST_SCORE[o.language];t.live?this._bestTitle=new PIXI.Text(t.text,{fontFamily:o.liveFont,fontSize:"32px",fill:16776960,align:"center",stroke:0,strokeThickness:6,padding:20,lineJoin:"round"}):this._bestTitle=new PIXI.extras.BitmapText(t.text,{font:"32px Gumball Yellow",tint:16777215,align:"center"}),this._bestTitle.anchor.set(.5),this._bestTitle.y=20,this._box.addChild(this._bestTitle),this._bestScore=new PIXI.extras.BitmapText(o.savedData.bestScore.toString(),{font:"32px Gumball Orange",tint:16777215,align:"center"}),this._bestScore.anchor.set(.5),this._bestScore.y=80,this._box.addChild(this._bestScore);var e=new p3.ButtonStates(o.assets.getTexture("but_large_def"),o.assets.getTexture("but_large_over"),o.assets.getTexture("but_large_pressed"),o.assets.getTexture("icon_replay_large"));this._playButton=new p3.Button(e),this._playButton.overSoundName="sfx_btn_rollover_00",this._playButton.downSoundName="sfx_btn_press_00",this._playButton.y=180,this._playButton.signals.down.addOnce(this.onPlayButtonClick,this),this._box.addChild(this._playButton);for(var i=new p3.MovieClipSequence,s=[],n=1;n<=33;n++){var a=""+n,r="0000",h=r.substring(0,r.length-a.length)+a;s.push(o.assets.getTexture("endlevel_darwin"+h))}for(var n=32;n>1;n--){var a=""+n,r="0000",h=r.substring(0,r.length-a.length)+a;s.push(o.assets.getTexture("endlevel_darwin"+h))}i.addTextures(s),this._darwin=new p3.MovieClip(i),this._darwin.x=o.STAGE_WIDTH/2+300,this._darwin.y=o.STAGE_HEIGHT-450,this._darwin.animationSpeed=.25,this._darwin.anchor=new PIXI.Point(.5),this._darwin.looping=!0,this._darwin.gotoAndPlay(0),this.addChild(this._darwin);for(var i=new p3.MovieClipSequence,s=[],n=1;n<=33;n++){var a=""+n,r="0000",h=r.substring(0,r.length-a.length)+a;s.push(o.assets.getTexture("endlevel_gumball"+h))}for(var n=32;n>1;n--){var a=""+n,r="0000",h=r.substring(0,r.length-a.length)+a;s.push(o.assets.getTexture("endlevel_gumball"+h))}i.addTextures(s),this._gumball=new p3.MovieClip(i),this._gumball.x=o.STAGE_WIDTH/2-320,this._gumball.y=o.STAGE_HEIGHT-450,this._gumball.animationSpeed=.25,this._gumball.anchor=new PIXI.Point(.5),this._gumball.looping=!0,this._gumball.gotoAndPlay(0),this.addChild(this._gumball);var l=new p3.ButtonStates(o.assets.getTexture("but_small_def"),o.assets.getTexture("but_small_over"),o.assets.getTexture("but_small_pressed"),o.assets.getTexture("icon_home"));this._homeButton=new p3.Button(l),this._homeButton.overSoundName="sfx_btn_rollover_00",this._homeButton.downSoundName="sfx_btn_press_00",this._homeButton.y=60,this._homeButton.signals.down.addOnce(this.onHomeButtonClick,this),this.addChild(this._homeButton),this._screenTransition=new PIXI.Sprite(o.generatedTextures.whiteSquare),this._screenTransition.tint=0,this._screenTransition.width=o.STAGE_WIDTH,this._screenTransition.height=o.STAGE_HEIGHT,this._screenTransition.visible=!1,this._screenTransition.interactive=!0,this.addChild(this._screenTransition)},s.prototype.destroy=function(){this._gameoverPS.destroy(),TweenMax.resumeAll(),p3.Scene.prototype.destroy.call(this)},s.prototype.end=function(){},s.prototype.show=function(){},s.prototype.animateIn=function(t,e){var i=new TimelineMax({onComplete:t,onCompleteScope:e});i.fromTo(this,.25,{alpha:0},{alpha:1,ease:Linear.easeNone}),i.fromTo(this._box.scale,.5,{x:0,y:0},{x:1,y:1,ease:Back.easeOut},.25),i.from(this._score.scale,.5,{x:0,y:0,ease:Back.easeOut,onStartScope:this,onStart:function(){this._gameoverPS.emit=!0}},.5),i.from(this._bestTitle.scale,.5,{x:0,y:0,ease:Back.easeOut},.8),i.from(this._bestScore.scale,.5,{x:0,y:0,ease:Back.easeOut},1.1),i.from(this._playButton.scale,.5,{x:0,y:0,ease:Back.easeOut},1.5),i.from(this._darwin,.6,{x:this._darwin.x+200,ease:Back.easeOut},.75),i.from(this._darwin,.6,{alpha:.01,ease:Sine.easeOut},.75),i.from(this._gumball,.6,{x:this._gumball.x-200,ease:Back.easeOut},.75),i.from(this._gumball,.6,{alpha:.01,ease:Sine.easeOut},.75)},s.prototype.animateOut=function(t,e){var i=new TimelineMax({onCompleteScope:e,onComplete:t});i.to(this,.25,{alpha:0,ease:Linear.easeNone})},s.prototype.animateOutExit=function(t,e){this._screenTransition.visible=!0;var i=new TimelineMax({onCompleteScope:e,onComplete:t});i.fromTo(this._screenTransition,.5,{alpha:0},{alpha:1,ease:Linear.easeNone})},s.prototype.resize=function(){this.x=.5*(p3.View.width-o.STAGE_WIDTH),this._homeButton.x=n.getFirstButtonPositionLeft()},s.prototype.update=function(){},s.prototype.onHomeButtonClick=function(){this.animateOutExit(function(){this.signals.previous.dispatch()},this)},s.prototype.onPlayButtonClick=function(){this.animateOutExit(function(){this.signals.next.dispatch()},this)}},{"../Common":8,"../Utils":11,"../ui/MuteButton":36}],26:[function(t,e,i){"use strict";function s(t){p3.Scene.call(this),this._tutorial=t||!1,this._slideIndex=0,this._slidesData=[{image:"fr_1",text:"INSTRUCTIONS_1_"+(p3.Device.isMobile?"MOB":"PC"),hand:new PIXI.Point((-220),70)},{image:"fr_2",text:"INSTRUCTIONS_2"},{image:"fr_3",text:"INSTRUCTIONS_3"},{image:"fr_4",text:"INSTRUCTIONS_4"}]}var o=t("../Common"),n=t("../Utils"),a=t("../ui/MuteButton");e.exports=s,s.prototype=Object.create(p3.Scene.prototype),s.prototype.constructor=s,s.prototype.init=function(){this.alpha=0,this._overlay=new PIXI.Sprite(o.generatedTextures.whiteSquare),this._overlay.tint=0,this._overlay.width=o.STAGE_WIDTH,this._overlay.height=o.STAGE_HEIGHT,this._overlay.alpha=.75,this._overlay.interactive=!0,this.addChild(this._overlay),this._box=new PIXI.Sprite(o.assets.getTexture("panel_00")),this._box.anchor.set(.5),this._box.x=o.STAGE_WIDTH/2,this._box.y=o.STAGE_HEIGHT/2,this.addChild(this._box);var t=o.copy[this._tutorial?"HOW_TO_PLAY":"PAUSED"][o.language];t.live?this._title=new PIXI.Text(t.text,{fontFamily:o.liveFont,fontSize:"40px",fill:16776960,align:"center",stroke:0,strokeThickness:6,padding:20,lineJoin:"round"}):this._title=new PIXI.extras.BitmapText(t.text,{font:"40px Gumball Yellow",tint:16777215,align:"center"}),this._title.anchor.set(.5),this._title.y=-210,this._box.addChild(this._title),this._slides=new PIXI.Container,this._box.addChild(this._slides),this._slides.image=new PIXI.Sprite(o.assets.getTexture(this._slidesData[this._slideIndex].image)),this._slides.image.anchor.set(.5),this._slides.image.y=-15,this._slides.addChild(this._slides.image),this._slides.handContainer=new PIXI.Container,this._slides.handContainer.visible=!!this._slidesData[this._slideIndex].hand,this._slides.handContainer.position=this._slidesData[this._slideIndex].hand||new PIXI.Point(0,0),this._slides.addChild(this._slides.handContainer),this._slides.handContainer.click=new PIXI.Sprite(o.assets.getTexture("loading_assett")),this._slides.handContainer.click.anchor.set(.5),this._slides.handContainer.click.x=10,this._slides.handContainer.click.y=-60,this._slides.handContainer.addChild(this._slides.handContainer.click),this._slides.handContainer.hand=new PIXI.Sprite(o.assets.getTexture("hand")),this._slides.handContainer.hand.anchor.set(.5),this._slides.handContainer.addChild(this._slides.handContainer.hand),this._handTimeline=new TimelineMax,this._handTimeline.fromTo(this._slides.handContainer.click,1,{alpha:1},{alpha:0,ease:Quart.easeIn,repeat:-1},0),this._handTimeline.fromTo(this._slides.handContainer.click.scale,1,{x:.2,y:.2},{x:1,y:1,ease:Sine.easeOut,repeat:-1},0),this._handTimeline.to(this._slides.handContainer.hand,1,{y:this._slides.handContainer.hand.y+10,ease:Sine.easeInOut,repeat:-1},0);var t=o.copy[this._slidesData[this._slideIndex].text][o.language];t.live?this._slides.text=new PIXI.Text(t.text,{fontFamily:o.liveFont,fontSize:"24px",fill:16776960,align:"center",stroke:0,strokeThickness:6,padding:20,lineJoin:"round"}):this._slides.text=new PIXI.extras.BitmapText(t.text,{font:"24px Gumball Green",tint:16777215,align:"center"}),this._slides.text.anchor.set(.5),this._slides.text.y=190,this._slides.addChild(this._slides.text);var e=new p3.ButtonStates(o.assets.getTexture("but_small_def"),o.assets.getTexture("but_small_over"),o.assets.getTexture("but_small_pressed"),o.assets.getTexture("icon_prevt"));this._prevButton=new p3.Button(e),this._prevButton.overSoundName="sfx_btn_rollover_00",this._prevButton.downSoundName="sfx_btn_press_00",this._prevButton.x=-370,this._prevButton.signals.down.add(this.onPrevButtonClick,this),this._prevButton.visible=!this._tutorial,this._box.addChild(this._prevButton);var i=new p3.ButtonStates(o.assets.getTexture("but_small_def"),o.assets.getTexture("but_small_over"),o.assets.getTexture("but_small_pressed"),o.assets.getTexture("icon_next"));this._nextButton=new p3.Button(i),this._nextButton.overSoundName="sfx_btn_rollover_00",this._nextButton.downSoundName="sfx_btn_press_00",this._nextButton.x=370,this._nextButton.signals.down.add(this.onNextButtonClick,this),this._box.addChild(this._nextButton);var s=new p3.ButtonStates(o.assets.getTexture("but_large_def"),o.assets.getTexture("but_large_over"),o.assets.getTexture("but_large_pressed"),o.assets.getTexture("icon_play"));this._playButton=new p3.Button(s),this._playButton.overSoundName="sfx_btn_rollover_00",this._playButton.downSoundName="sfx_btn_press_00",this._playButton.x=370,this._playButton.y=220,this._playButton.signals.down.addOnce(this.onPlayButtonClick,this),this._playButton.visible=!this._tutorial,this._box.addChild(this._playButton);var n=new p3.ButtonStates(o.assets.getTexture("but_small_def"),o.assets.getTexture("but_small_over"),o.assets.getTexture("but_small_pressed"),o.assets.getTexture("icon_home"));this._homeButton=new p3.Button(n),this._homeButton.overSoundName="sfx_btn_rollover_00",this._homeButton.downSoundName="sfx_btn_press_00",this._homeButton.y=60,this._homeButton.signals.down.addOnce(this.onHomeButtonClick,this),this._homeButton.visible=!this._tutorial,this.addChild(this._homeButton);var r=new p3.ButtonStates(o.assets.getTexture("but_small_def"),o.assets.getTexture("but_small_over"),o.assets.getTexture("but_small_pressed"),o.assets.getTexture("icon_sound_"+(o.audio.isMute?"off":"on")));this._muteButton=new a(r,o.assets.getTexture("icon_sound_on"),o.assets.getTexture("icon_sound_off")),this._muteButton.y=80,this.addChild(this._muteButton),this._screenTransition=new PIXI.Sprite(o.generatedTextures.whiteSquare),this._screenTransition.tint=0,this._screenTransition.width=o.STAGE_WIDTH,this._screenTransition.height=o.STAGE_HEIGHT,this._screenTransition.visible=!1,this._screenTransition.interactive=!0,this.addChild(this._screenTransition)},s.prototype.destroy=function(){p3.Scene.prototype.destroy.call(this),this._handTimeline&&this._handTimeline.kill(),TweenMax.resumeAll()},s.prototype.end=function(){},s.prototype.show=function(){},s.prototype.animateIn=function(t,e){var i=new TimelineMax({onComplete:t,onCompleteScope:e});i.fromTo(this,.25,{alpha:0},{alpha:1,ease:Linear.easeNone}),i.fromTo(this._homeButton.scale,.5,{x:0,y:0},{x:1,y:1,ease:Back.easeOut},.3),i.fromTo(this._muteButton.scale,.5,{x:0,y:0},{x:1,y:1,ease:Back.easeOut},.5)},s.prototype.animateOut=function(t,e){var i=new TimelineMax({onCompleteScope:e,onComplete:t});i.to(this,.25,{alpha:0,ease:Linear.easeNone})},s.prototype.animateOutExit=function(t,e){this._screenTransition.visible=!0;var i=new TimelineMax({onCompleteScope:e,onComplete:t});i.fromTo(this._screenTransition,.5,{alpha:0},{alpha:1,ease:Linear.easeNone})},s.prototype.resize=function(){this.x=.5*(p3.View.width-o.STAGE_WIDTH),this._homeButton.x=n.getFirstButtonPositionLeft(),this._muteButton.x=n.getFirstButtonPositionRight()},s.prototype.update=function(){},s.prototype.updateSlideContent=function(){this._slides.image.texture=o.assets.getTexture(this._slidesData[this._slideIndex].image),this._slides.text.text=o.copy[this._slidesData[this._slideIndex].text][o.language].text,this._slides.handContainer.visible=!!this._slidesData[this._slideIndex].hand,this._slides.handContainer.position=this._slidesData[this._slideIndex].hand||new PIXI.Point(0,0)},s.prototype.onHomeButtonClick=function(){this.animateOutExit(function(){this.signals.previous.dispatch()},this)},s.prototype.onPlayButtonClick=function(){this.animateOut(function(){this.signals.next.dispatch()},this)},s.prototype.onPrevButtonClick=function(){this._slideIndex--,this._slideIndex<0&&(this._slideIndex=this._slidesData.length-1),this.updateSlideContent()},s.prototype.onNextButtonClick=function(){this._slideIndex++,this._slideIndex>=this._slidesData.length&&(this._slideIndex=0),this.updateSlideContent(),this._playButton.visible||this._slideIndex!=this._slidesData.length-1||(TweenMax.fromTo(this._playButton.scale,.5,{x:0,y:0},{x:1,y:1,ease:Back.easeOut},0),this._playButton.visible=!0,this._nextButton.visible=!1,o.savedData.tutorial=!0,o.savedData.save())}},{"../Common":8,"../Utils":11,"../ui/MuteButton":36}],27:[function(t,e,i){"use strict";function s(){p3.Scene.call(this)}var o=t("../Common"),n=t("../Utils"),a=t("../ui/MuteButton"),r=t("../ui/CharacterWheel");e.exports=s,s.prototype=Object.create(p3.Scene.prototype),s.prototype.constructor=s,s.prototype.init=function(){this._characterWheel=new r(o.assets.getJSON("config").characters,o.savedData.character),this._characterWheel.x=o.STAGE_WIDTH/2,this._characterWheel.y=o.STAGE_HEIGHT/2-50,this._characterWheel.signals.onCharacterChanged.add(function(t){o.savedData.character=t,o.savedData.save()}.bind(this)),this.addChild(this._characterWheel);var t=o.copy.SELECT_CHARACTER[o.language];t.live?this._title=new PIXI.Text(t.text,{fontFamily:o.liveFont,fontSize:"48px",fill:16776960,align:"center",stroke:0,strokeThickness:6,padding:20,lineJoin:"round"}):this._title=new PIXI.extras.BitmapText(t.text,{font:"48px Gumball Yellow",tint:16777215,align:"center"}),this._title.anchor.set(.5),this._title.position.set(o.STAGE_WIDTH/2,80),this.addChild(this._title);var e=new p3.ButtonStates(o.assets.getTexture("but_large_def"),o.assets.getTexture("but_large_over"),o.assets.getTexture("but_large_pressed"),o.assets.getTexture("icon_play"));this._playButton=new p3.Button(e),this._playButton.overSoundName="sfx_btn_rollover_00",this._playButton.downSoundName="sfx_btn_press_00",this._playButton.x=o.STAGE_WIDTH/2,this._playButton.y=o.STAGE_HEIGHT-200,this._playButton.signals.down.addOnce(this.onPlayButtonClick,this),this.addChild(this._playButton);var i=new p3.ButtonStates(o.assets.getTexture("but_small_def"),o.assets.getTexture("but_small_over"),o.assets.getTexture("but_small_pressed"),o.assets.getTexture("icon_home"));this._homeButton=new p3.Button(i),this._homeButton.overSoundName="sfx_btn_rollover_00",this._homeButton.downSoundName="sfx_btn_press_00",this._homeButton.y=80,this._homeButton.signals.down.addOnce(this.onHomeButtonClick,this),this.addChild(this._homeButton);var s=new p3.ButtonStates(o.assets.getTexture("but_small_def"),o.assets.getTexture("but_small_over"),o.assets.getTexture("but_small_pressed"),o.assets.getTexture("icon_sound_"+(o.audio.isMute?"off":"on")));this._muteButton=new a(s,o.assets.getTexture("icon_sound_on"),o.assets.getTexture("icon_sound_off")),this._muteButton.y=80,this.addChild(this._muteButton),this._screenTransition=new PIXI.Sprite(o.generatedTextures.whiteSquare),this._screenTransition.tint=0,this._screenTransition.width=o.STAGE_WIDTH,this._screenTransition.height=o.STAGE_HEIGHT,this._screenTransition.alpha=0,this.addChild(this._screenTransition)},s.prototype.destroy=function(){this._animateTimeline&&this._animateTimeline.kill(),p3.Scene.prototype.destroy.call(this)},s.prototype.end=function(){},s.prototype.show=function(){},s.prototype.animateIn=function(t,e){this._screenTransition.interactive=!1,this._animateTimeline=new TimelineMax({onComplete:t,onCompleteScope:e}),this._animateTimeline.fromTo(this,.5,{alpha:0},{alpha:1,ease:Sine.easeInOut},0),this._animateTimeline.fromTo(this._playButton.scale,.5,{x:0,y:0},{x:1,y:1,ease:Back.easeOut},.5),this._animateTimeline.fromTo(this._muteButton.scale,.5,{x:0,y:0},{x:1,y:1,ease:Back.easeOut},1),this._animateTimeline.fromTo(this._homeButton.scale,.5,{x:0,y:0},{x:1,y:1,ease:Back.easeOut},.8),this._animateTimeline.fromTo(this._title.scale,.5,{x:0},{x:1,ease:Back.easeOut},.2),this._characterWheel.animateIn()},s.prototype.animateOut=function(t,e){this._screenTransition.interactive=!0,this._animateTimeline&&this._animateTimeline.kill(),this._animateTimeline=new TimelineMax({onCompleteScope:e,onComplete:t}),this._animateTimeline.to(this,.5,{alpha:0,ease:Sine.easeInOut},0)},s.prototype.resize=function(){this.x=.5*(p3.View.width-o.STAGE_WIDTH),this._muteButton.x=n.getFirstButtonPositionRight(),this._homeButton.x=n.getFirstButtonPositionLeft()},s.prototype.update=function(){this._characterWheel.update()},s.prototype.onPlayButtonClick=function(){o.background.hideObjects(),this.animateOut(function(){this.signals.next.dispatch()},this)},s.prototype.onHomeButtonClick=function(){this.animateOut(function(){this.signals.previous.dispatch()},this)}},{"../Common":8,"../Utils":11,"../ui/CharacterWheel":33,"../ui/MuteButton":36}],28:[function(t,e,i){"use strict";function s(t){p3.Scene.call(this),this._userTouch=!1,this._tutorial=o.savedData.tutorial,this._quickTransition=t||!1,this.signals.restart=new signals.Signal,this.signals.gameover=new signals.Signal,this.signals.pause=new signals.Signal}var o=t("../Common"),n=t("../Utils"),a=(t("../ui/MuteButton"),t("../ui/GameUI")),r=t("../game/World");t("../game/WorldBackground");e.exports=s,s.prototype=Object.create(p3.Scene.prototype),s.prototype.constructor=s,s.prototype.init=function(){this._world=new r,this.addChild(this._world),this._ui=new a(this),this.addChild(this._ui),this._world.signals.playerLanded.add(function(t){this._ui.updateScore(t)},this),this._world.signals.windChanged.add(function(t){this._ui.updateWind(t),o.audio.playSound(Math.sign(t)>=0?"sfx_windchange_positive_01":"sfx_windchange_negative_01")},this),this._world.signals.playerDied.add(function(t){o.audio.stopMusic(),o.bgMusic=null,o.audio.playSound("music_fail_02",{volume:o.bgMusicVolume}),o.savedData.recordScore(t),this.onDeath()},this),this._world.signals.powerupPicked.add(function(t,e){this._ui.showPowerup(t,e)},this),this._world.signals.powerupUsed.add(function(t,e){this._ui.hidePowerup(t,e)},this),this._world.signals.multiplierPicked.add(function(t){this._ui.showMultiplier(t)},this),this._world.signals.multiplierUsed.add(function(){this._ui.hideMultiplier()},this),this._interactiveArea=new PIXI.Sprite(o.generatedTextures.whiteSquare),this._interactiveArea.width=o.STAGE_WIDTH,this._interactiveArea.height=o.STAGE_HEIGHT,this._interactiveArea.alpha=0,this._interactiveArea.interactive=!0,this._interactiveArea.mousedown=this._interactiveArea.touchstart=this.onMouseDown.bind(this),this.addChild(this._interactiveArea);var t=new p3.ButtonStates(o.assets.getTexture("but_small_def"),o.assets.getTexture("but_small_over"),o.assets.getTexture("but_small_pressed"),o.assets.getTexture("icon_pause"));this._pauseButton=new p3.Button(t),this._pauseButton.y=80,this._pauseButton.overSoundName="sfx_btn_rollover_00",this._pauseButton.downSoundName="sfx_btn_press_00",this._pauseButton.signals.down.add(this.onPauseButtonClick,this),this.addChild(this._pauseButton),this._screenTransition=new PIXI.Sprite(o.generatedTextures.whiteSquare),this._screenTransition.tint=0,this._screenTransition.width=o.STAGE_WIDTH,this._screenTransition.height=o.STAGE_HEIGHT,this._screenTransition.alpha=0,this.addChild(this._screenTransition)},s.prototype.destroy=function(){p3.Scene.prototype.destroy.call(this),this._world.destroy({children:!0}),this._animateTimeline&&this._animateTimeline.kill()},s.prototype.end=function(){},s.prototype.show=function(){TweenMax.resumeAll()},s.prototype.animateIn=function(t,e){this._screenTransition.interactive=!1,this._animateTimeline=new TimelineMax({onComplete:t,onCompleteScope:e}),this._animateTimeline.fromTo(this._pauseButton.scale,.5,{x:0,y:0},{x:1,y:1,ease:Back.easeOut},this._tutorial?1:4),this._quickTransition?this._animateTimeline.fromTo(this,.5,{alpha:0},{alpha:1,ease:Sine.easeInOut},0):this._animateTimeline.fromTo(this._screenTransition,.5,{alpha:1},{alpha:0,ease:Sine.easeInOut},0),this._tutorial||(this._tutorial=!0,TweenMax.to(this,2.5,{onCompleteScope:this,onComplete:function(){this.signals.pause.dispatch(!0)}},0));var i=["music_gameloop_00","music_bonusloop_00"];o.audio.stopMusic(),o.bgMusic=o.audio.playMusic(i[o.savedData.gameMusic%i.length],{loop:!0,volume:0}),o.bgMusic.howl.fade(0,o.bgMusicVolume,1e3,o.bgMusic.id),o.savedData.gameMusic++},s.prototype.animateOut=function(t,e){this._screenTransition.interactive=!0,this._animateTimeline&&this._animateTimeline.kill(),this._animateTimeline=new TimelineMax({onCompleteScope:e,onComplete:t}),this._animateTimeline.to(this._screenTransition,.5,{alpha:1,ease:Linear.easeNone}),o.bgMusic&&o.bgMusic.howl.fade(o.bgMusicVolume,0,500,o.bgMusic.id)},s.prototype.resize=function(){this.x=.5*(p3.View.width-o.STAGE_WIDTH),this._ui.resize(),this._pauseButton.x=n.getFirstButtonPositionRight()},s.prototype.update=function(){this._world.update()},s.prototype.onPlayButtonClick=function(){this.animateOut(function(){this.signals.next.dispatch()},this)},s.prototype.onPauseButtonClick=function(){TweenMax.pauseAll(),this.signals.pause.dispatch()},s.prototype.onDeath=function(){TweenMax.pauseAll(),this.signals.gameover.dispatch()},s.prototype.onMouseDown=function(){this._tutorial&&this._world.userEvent()}},{"../Common":8,"../Utils":11,"../game/World":21,"../game/WorldBackground":22,"../ui/GameUI":35,"../ui/MuteButton":36}],29:[function(t,e,i){"use strict";function s(){this.loaded=0,this.boomerang=!1,p3.Scene.call(this)}var o=t("../Common");t("../Brim");e.exports=s,s.prototype=Object.create(p3.Scene.prototype),s.prototype.varructor=s,s.prototype.init=function(){Howler.ctx.resume();var t=new PIXI.Text("Test",{fontFamily:o.liveFont,fontSize:"32px",fill:0,align:"center",stroke:0,strokeThickness:1});if(t.alpha=0,this.addChild(t),this.boomerang){var e=new PIXI.Graphics;e.clear(),e.beginFill(8859527),e.drawRect(0,0,o.STAGE_WIDTH,o.STAGE_HEIGHT),e.endFill(),this.addChild(e);var i=new PIXI.Container;i.x=.5*o.STAGE_WIDTH,i.y=.5*o.STAGE_HEIGHT+46,this.addChild(i);for(var s=[],n=1;n<10;++n)s.push(o.assets.getTexture("loader_animation000"+n));s.push(o.assets.getTexture("loader_animation0010"));var a=new p3.MovieClipSequence;a.addTextures(s),this._logo=new p3.MovieClip(a),this._logo.x=50,this._logo.y=20,this._logo.anchor.set(.5,1),this._logo.animationSpeed=.25,this._logo.looping=!1,i.addChild(this._logo),this._bar=new PIXI.Sprite(o.assets.getTexture("preloader_bg")),this._bar.y=34,this._bar.anchor.set(.5),i.addChild(this._bar),this._bar.fill=new PIXI.Sprite(o.assets.getTexture("preloader_bar")),this._bar.fill.anchor.set(.5),this._bar.addChild(this._bar.fill),this._bar.fill.mask=new PIXI.Graphics,this._bar.fill.mask.x=.5*-this._bar.fill.texture.width,this._bar.fill.mask.scale.x=0,this._bar.fill.mask.beginFill(16711680),this._bar.fill.mask.drawRect(0,.5*-this._bar.fill.texture.height,this._bar.fill.texture.width,this._bar.fill.texture.height),this._bar.fill.addChild(this._bar.fill.mask),this._bar.frame=new PIXI.Sprite(o.assets.getTexture("preloader_overlay")),this._bar.frame.anchor=new PIXI.Point(.5,.5),this._bar.addChild(this._bar.frame),this._text=new PIXI.Text("0%",{fontSize:"32px",fontFamily:"Arial",fill:"#FFFFFF",align:"center"}),this._text.y=this._bar.y+60,this._text.anchor.set(.5),i.addChild(this._text)}if(!this.boomerang){var r=new PIXI.Sprite(o.assets.getTexture("preloader_cn_bg"));this.addChild(r),this._bar=new PIXI.Container,this._bar.x=o.STAGE_WIDTH/2,this._bar.y=o.STAGE_HEIGHT/2+150,this._bar.scale.set(.5),this.addChild(this._bar),this._bar.fill=new PIXI.Sprite(o.assets.getTexture("preloader_cn_fill")),this._bar.fill.anchor.set(.5),this._bar.fill.x=-this._bar.fill.width,this._bar.fill.y=0,this._bar.addChild(this._bar.fill),this._bar.overlay=new PIXI.Sprite(o.assets.getTexture("preloader_cn_overlay")),this._bar.overlay.anchor.set(.5),this._bar.overlay.x=-500,this._bar.addChild(this._bar.overlay);var h=new PIXI.Graphics;h.clear(),h.beginFill(0),h.drawRect(-o.STAGE_WIDTH/2,0,o.STAGE_WIDTH-400,o.STAGE_HEIGHT),h.endFill(),this.addChild(h)}var l=new p3.ButtonStates(o.assets.getTexture("but_large_def"),o.assets.getTexture("but_large_over"),o.assets.getTexture("but_large_pressed"),o.assets.getTexture("icon_play"));this._playButton=new p3.Button(l),this._playButton.x=.5*o.STAGE_WIDTH,this._playButton.y=o.STAGE_HEIGHT-220,this._playButton.overSoundName="sfx_btn_rollover_00",this._playButton.downSoundName="sfx_btn_press_00",this._playButton.animate=!0,this._playButton.visible=!1,this._playButton.signals.click.add(this.onPlayButtonClick,this),this.addChild(this._playButton)},s.prototype.destroy=function(){p3.Scene.prototype.destroy.call(this)},s.prototype.appear=function(){p3.Scene.prototype.appear.call(this),this.animateIn(),this._logo&&this._logo.play()},s.prototype.show=function(){},s.prototype.animateIn=function(t,e){},s.prototype.animateOut=function(t,e){},s.prototype.resize=function(){this.x=.5*(p3.View.width-o.STAGE_WIDTH),this.y=.5*(p3.View.height-o.STAGE_HEIGHT)},s.prototype.update=function(){var t=Math.min(1,this.loaded);this._text&&(this._text.text=Math.round(100*t)+"%"),this.boomerang?this._bar.fill.mask.scale.x+=.4*(t-this._bar.fill.mask.scale.x):this._bar.fill.x=-(1-t)*this._bar.fill.width,1==this.loaded&&(p3.Device.isMobile?this._playButton.visible||(this._playButton.visible=!0,this._text&&(this._text.visible=!1),TweenMax.to(this._bar.scale,.35,{x:0,y:0,ease:Back.easeIn}),TweenMax.fromTo(this._playButton.scale,.35,{x:0,y:0},{x:1,y:1,ease:Back.easeOut,delay:.35})):this.signals.next.dispatch(this))},s.prototype.onPlayButtonClick=function(t){Howler.ctx.resume(),p3.Device.isAndroid&&screenfull.enabled&&(screenfull.request(),setTimeout(function(){o.view.resize()},1e3)),this._playButton.interactive=!1,this._playButton.onMouseOut(),TweenMax.to(this._playButton.scale,.35,{x:0,y:0,ease:Back.easeIn,onCompleteScope:this,onComplete:function(){this.signals.next.dispatch(this)}})}},{"../Brim":7,"../Common":8}],30:[function(t,e,i){"use strict";function s(t){p3.Scene.call(this),this._quickTransition=t||!1}var o=t("../Common"),n=t("../Utils"),a=t("../ui/MuteButton");e.exports=s,s.prototype=Object.create(p3.Scene.prototype),s.prototype.constructor=s,s.prototype.init=function(){this._container=new PIXI.Container,this._container.x=o.STAGE_WIDTH/2,this._container.y=o.STAGE_HEIGHT/2,this.addChild(this._container),this._darwinRock=new PIXI.Sprite(o.assets.getTexture("platform_2")),
this._darwinRock.anchor.set(.5,0),this._darwinRock.x=-280,this._darwinRock.y=570-o.STAGE_HEIGHT/2,this._container.addChild(this._darwinRock),this._darwin=new PIXI.Sprite(o.assets.getTexture("splash_darwin")),this._darwin.anchor.set(.5,1),this._darwin.y=30,this._darwinRock.addChild(this._darwin),this._logo=new PIXI.Sprite(o.assets.getTexture("gumball_logo")),this._logo.anchor.set(.5),this._logo.position.set(0,100-o.STAGE_HEIGHT/2),this._container.addChild(this._logo),this._title=new PIXI.Sprite(o.assets.getTexture("title")),this._title.anchor.set(.5),this._title.position.set(0,300-o.STAGE_HEIGHT/2),this._container.addChild(this._title),this._gumball=new PIXI.Sprite(o.assets.getTexture("splash_gumball")),this._gumball.anchor.set(50/this._gumball.width,54/this._gumball.height),this._gumball.x=250,this._gumball.y=-o.STAGE_HEIGHT/2,this._gumball.rotation=90*PIXI.DEG_TO_RAD,this._container.addChild(this._gumball);var t=new p3.ButtonStates(o.assets.getTexture("but_large_def"),o.assets.getTexture("but_large_over"),o.assets.getTexture("but_large_pressed"),o.assets.getTexture("icon_play"));this._playButton=new p3.Button(t),this._playButton.overSoundName="sfx_btn_rollover_00",this._playButton.downSoundName="sfx_btn_press_00",this._playButton.x=o.STAGE_WIDTH/2,this._playButton.y=o.STAGE_HEIGHT-200,this._playButton.signals.down.addOnce(this.onPlayButtonClick,this),this.addChild(this._playButton),this._cnLogo=new PIXI.Sprite(o.assets.getTexture("cn_logo")),this._cnLogo.anchor.set(0,1),this.addChild(this._cnLogo);var e=new p3.ButtonStates(o.assets.getTexture("but_small_def"),o.assets.getTexture("but_small_over"),o.assets.getTexture("but_small_pressed"),o.assets.getTexture("icon_sound_"+(o.audio.isMute?"off":"on")));this._muteButton=new a(e,o.assets.getTexture("icon_sound_on"),o.assets.getTexture("icon_sound_off")),this._muteButton.y=80,this.addChild(this._muteButton),this._screenTransition=new PIXI.Sprite(o.generatedTextures.whiteSquare),this._screenTransition.tint=0,this._screenTransition.width=o.STAGE_WIDTH,this._screenTransition.height=o.STAGE_HEIGHT,this._screenTransition.alpha=0,this.addChild(this._screenTransition)},s.prototype.destroy=function(){p3.Scene.prototype.destroy.call(this),this._animateTimeline&&this._animateTimeline.kill()},s.prototype.end=function(){},s.prototype.show=function(){},s.prototype.animateIn=function(t,e){this._screenTransition.interactive=!1,this._animateTimeline=new TimelineMax({onComplete:t,onCompleteScope:e});var i=0;this._quickTransition?this._animateTimeline.fromTo(this,.5,{alpha:0},{alpha:1,ease:Sine.easeInOut},0):(this._animateTimeline.fromTo(this._screenTransition,.5,{alpha:1},{alpha:0,ease:Sine.easeInOut},0),i=.4),this._animateTimeline.fromTo(this._muteButton.scale,.5,{x:0,y:0},{x:1,y:1,ease:Back.easeOut},1),this._animateTimeline.fromTo(this._logo.scale,1.2,{x:0},{x:1,ease:Elastic.easeOut},i),this._animateTimeline.fromTo(this._logo.scale,1.6,{y:0},{y:1,ease:Elastic.easeOut},i),this._animateTimeline.to(this._logo.scale,1.3215,{x:1.1,ease:Quad.easeInOut,repeat:-1,yoyo:!0},i+2),this._animateTimeline.to(this._logo.scale,2,{y:1.1,ease:Quad.easeInOut,repeat:-1,yoyo:!0},i+2),this._animateTimeline.fromTo(this._title.scale,.6,{x:0,y:0},{x:1,y:1,ease:Sine.easeOut},i+.1),this._animateTimeline.from(this._title,.6,{y:this._title.y-350,ease:Bounce.easeOut},i+.1),this._animateTimeline.fromTo(this._title,.6,{alpha:0},{alpha:1,ease:Sine.easeOut},i+.1),this._animateTimeline.to(this._title,1,{rotation:-5*PIXI.DEG_TO_RAD,ease:Sine.easeOut},i+.1),this._animateTimeline.to(this._title,2,{rotation:5*PIXI.DEG_TO_RAD,ease:Sine.easeInOut,yoyo:!0,repeat:-1},i+.1+1),this._animateTimeline.fromTo(this._gumball,1.2,{rotation:90*PIXI.DEG_TO_RAD},{rotation:-0*PIXI.DEG_TO_RAD,ease:Sine.easeOut},i+.5),this._animateTimeline.fromTo(this._gumball,.5,{alpha:0},{alpha:1,ease:Linear.easeNone},i+.5),this._animateTimeline.to(this._gumball,1.8,{rotation:25*PIXI.DEG_TO_RAD,ease:Sine.easeInOut,repeat:-1,yoyo:!0},1.2+i+.5),this._animateTimeline.from(this._darwin,1,{y:this._darwin.y-500,ease:Bounce.easeOut},i+.9),this._animateTimeline.from(this._darwin,.3,{alpha:.01,ease:Linear.easeNone,onCompleteScope:this,onComplete:function(){o.audio.playSound("sfx_impactfloor03")}},i+.9),this._animateTimeline.to(this._darwin.scale,1.6,{y:1.1,ease:Sine.easeInOut,repeat:-1,yoyo:!0},i+.9),this._animateTimeline.to(this._darwinRock,3.6,{x:this._darwinRock.x+60,ease:Sine.easeInOut,repeat:-1,yoyo:!0},i+.9),this._animateTimeline.to(this._darwinRock,5,{y:this._darwinRock.y-20,ease:Sine.easeInOut,repeat:-1,yoyo:!0},i+.9),this._animateTimeline.from(this._darwinRock,.5,{y:this._darwinRock.y+200,ease:Sine.easeOut},i+.6),this._animateTimeline.from(this._darwinRock,.5,{alpha:.01,ease:Linear.easeNone},i+.6),this._animateTimeline.fromTo(this._playButton.scale,.3,{x:0,y:0},{x:1,y:1,ease:Back.easeOut},i+1.1),o.background.showObjects(),o.audio.stopMusic(),o.bgMusic=o.audio.playMusic("music_menuloop_00",{loop:!0,volume:0}),o.bgMusic.howl.fade(0,o.bgMusicVolume,1e3,o.bgMusic.id)},s.prototype.animateOut=function(t,e){this._screenTransition.interactive=!0,this._animateTimeline&&this._animateTimeline.kill(),this._animateTimeline=new TimelineMax({onCompleteScope:e,onComplete:t}),this._animateTimeline.to(this,.5,{alpha:0,ease:Sine.easeInOut},0)},s.prototype.resize=function(){this.x=.5*(p3.View.width-o.STAGE_WIDTH),this._muteButton.x=n.getFirstButtonPositionRight(),this._cnLogo.x=n.getFirstButtonPositionLeft()-30,this._cnLogo.y=o.STAGE_HEIGHT-50},s.prototype.update=function(){},s.prototype.onPlayButtonClick=function(){this.animateOut(function(){this.signals.next.dispatch()},this)}},{"../Common":8,"../Utils":11,"../ui/MuteButton":36}],31:[function(t,e,i){"use strict";function s(e){this.maskSprite=e,this.maskMatrix=new PIXI.Matrix;var i=(t("glslify"),"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord ;\n}"),s="#define GLSLIFY 1\nvarying lowp vec2 vFilterCoord;\nvarying lowp vec2 vTextureCoord;\nuniform lowp sampler2D uSampler;\nuniform lowp float time;\nuniform lowp float waveIntensity;\nuniform lowp vec2 bandCoords;\nuniform lowp vec3 bandColor;\nuniform mat3 mappedMatrix;\n\nfloat when_gt(float x, float y)\n{\n  return max(sign(x - y), 0.0);\n}\n\nfloat when_lt(float x, float y)\n{\n  return max(sign(y - x), 0.0);\n}\n\nvoid main()\n{\n\tlowp vec3 uv = vec3(vTextureCoord, 1.0) * mappedMatrix;\n\n\tvec2 tc = vec2(vTextureCoord.x, vTextureCoord.y);\n\n\t// Screen effect\n\ttc.y -= cos((uv.x - 0.5) * 2.0) * ((uv.y - 0.5) * 2.0) * 0.15;\n\n\t// Wave effect\n\ttc.x += sin(uv.y * 50.0  + time) * waveIntensity;\n\ttc.x = clamp(tc.x, waveIntensity, vTextureCoord.x/uv.x - waveIntensity);\n\n\t// Band distortion effect\n\tfloat bandEffect = when_gt(uv.y, bandCoords.x) * when_lt(uv.y, bandCoords.y);\n\ttc.y += sin(vTextureCoord.x * (mod(time, 10.0))) * 0.1 * bandEffect;\n\n\t// Color\n\tlowp vec4 color = texture2D(uSampler, tc);\n\n\t// Band color effect\n\tcolor.rgb += bandColor * bandEffect;\n\n\t// Premultiplied alpha - important!\n\tcolor.rgb *= color.a;\n\n\t// Output\n\tgl_FragColor = color;\n}";PIXI.Filter.call(this,i,s,{time:{type:"f",value:0},waveIntensity:{type:"f",value:.01},bandCoords:{type:"vec2",value:[0,0]},bandColor:{type:"vec2",value:[0,0,0]},mappedMatrix:{type:"mat3",value:this.maskMatrix}})}e.exports=s,s.prototype=Object.create(PIXI.Filter.prototype),s.prototype.constructor=s,s.prototype.apply=function(t,e,i){this.maskSprite?this.uniforms.mappedMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite):t.calculateNormalizedScreenSpaceMatrix(this.uniforms.mappedMatrix),t.applyFilter(this,e,i)}},{glslify:1}],32:[function(t,e,i){"use strict";function s(e){this.maskSprite=e,this.maskMatrix=new PIXI.Matrix;var i=(t("glslify"),"#define GLSLIFY 1\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vFilterCoord = ( filterMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vTextureCoord = aTextureCoord ;\n}"),s="#define GLSLIFY 1\nvarying lowp vec2 vFilterCoord;\nvarying lowp vec2 vTextureCoord;\nuniform lowp sampler2D uSampler;\nuniform lowp float pixels;\nuniform mat3 mappedMatrix;\n\nvoid main()\n{\n\t// lowp vec3 uv    = vec3(vTextureCoord, 1.0) * mappedMatrix;\n\n\tlowp vec4 color = texture2D(uSampler, floor(vTextureCoord * pixels) /pixels);\n\tcolor.rgb *= color.a; // Premultiplied alpha - important!\n\n\tgl_FragColor = color;\n}";PIXI.Filter.call(this,i,s,{pixels:{type:"f",value:100},mappedMatrix:{type:"mat3",value:this.maskMatrix}})}e.exports=s,s.prototype=Object.create(PIXI.Filter.prototype),s.prototype.constructor=s,s.prototype.apply=function(t,e,i){this.maskSprite?this.uniforms.mappedMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite):t.calculateNormalizedScreenSpaceMatrix(this.uniforms.mappedMatrix),t.applyFilter(this,e,i)}},{glslify:1}],33:[function(t,e,i){"use strict";function s(t,e){PIXI.Container.call(this),this._data=t,this._id=e,this._characters=[],this._index=0,this.init(),this.signals={},this.signals.onCharacterChanged=new signals.Signal}var o=t("../Common"),n=(t("../Utils"),t("./CharacterWheelCharacter"));s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,e.exports=s,s.prototype.init=function(){this._wheel=new PIXI.Container,this.addChild(this._wheel);for(var t in this._data){t==this._id&&(this._index=this._characters.length);var e=new n(t,this._data[t].portrait,this._data[t].portraitScale||1,this._data[t].portraitPos||{x:0,y:0});this._characters.push(e),this._wheel.addChild(e)}for(var i=0;i<this._characters.length;i++){var s=(this._index+i)%this._characters.length,a=(90+i*(360/this._characters.length))*PIXI.DEG_TO_RAD;this._characters[s].setAngle(a)}this._prev=new PIXI.Sprite(o.assets.getTexture("icon_next_2")),this._prev.anchor.set(.5),this._prev.x=-160,this._prev.y=50,this._prev.scale.x=-1,this._prev.interactive=!0,this._prev.cursor="pointer",this._prev.mousedown=this._prev.touchstart=this.onPrevDown.bind(this),this.addChild(this._prev),this._next=new PIXI.Sprite(o.assets.getTexture("icon_next_2")),this._next.anchor.set(.5),this._next.x=-this._prev.x,this._next.y=this._prev.y,this._next.interactive=!0,this._next.cursor="pointer",this._next.mousedown=this._next.touchstart=this.onNextDown.bind(this),this.addChild(this._next)},s.prototype.update=function(){this._wheel.children.sort(function(t,e){return t.scale.x<e.scale.x?-1:t.scale.x>e.scale.x?1:0})},s.prototype.animateIn=function(){this._animateTimeline=new TimelineMax;for(var t=.2,e=0;e<Math.ceil(this._characters.length/2);e++){var i=(this._index+e)%this._characters.length;this._animateTimeline.from(this._characters[i],.5,{y:this._characters[i].y+400*this._characters[i].scale.y,ease:Back.easeOut},e*t),this._animateTimeline.from(this._characters[i],.3,{alpha:.01,ease:Linear.easeNone},e*t)}for(var e=1;e<Math.ceil(this._characters.length/2);e++){var i=(this._index-e+this._characters.length)%this._characters.length;this._animateTimeline.from(this._characters[i],.5,{y:this._characters[i].y+400*this._characters[i].scale.y,ease:Back.easeOut},e*t),this._animateTimeline.from(this._characters[i],.3,{alpha:.01,ease:Linear.easeNone},e*t)}this._animateTimeline.from(this._prev,.5,{x:this._prev.x+100,ease:Back.easeOut},.5),this._animateTimeline.from(this._prev,.5,{alpha:0,ease:Sine.easeOut},.5),this._animateTimeline.from(this._next,.5,{x:this._next.x-100,ease:Back.easeOut},.5),this._animateTimeline.from(this._next,.5,{alpha:0,ease:Sine.easeOut},.5)},s.prototype.animate=function(t){for(this._index-=t;this._index<0;)this._index+=this._characters.length;for(;this._index>=this._characters.length;)this._index-=this._characters.length;this._id=this._characters[this._index].id,this.signals.onCharacterChanged.dispatch(this._id);for(var e=0;e<this._characters.length;e++){var i=this._characters[e].angle+2*Math.PI/this._characters.length*t;this._characters[e].moveToAngle(i)}o.audio.playSound("sfx_character_choose_swipe_00")},s.prototype.onPrevDown=function(){this.animate(-1)},s.prototype.onNextDown=function(){this.animate(1)}},{"../Common":8,"../Utils":11,"./CharacterWheelCharacter":34}],34:[function(t,e,i){"use strict";function s(t,e,i,s){PIXI.Container.call(this),this._id=t,this._angle=0,this._angleTarget=0;var n=["platform_4","platform_2","platform_3","platform_3_b"];this._platform=new PIXI.Sprite(o.assets.getTexture(n[p3.Utils.randomInt(0,n.length-1)])),this._platform.anchor.set(.5,0),this._platform.scale.x=Math.random()<.5?-1:1,this.addChild(this._platform),this._sprite=new PIXI.Sprite(o.assets.getTexture(e)),this._sprite.anchor.set(.5,1),this._sprite.x=s.x,this._sprite.y=30+s.y,this._sprite.scale.set(i),this.addChild(this._sprite)}var o=t("../Common");t("../Utils");s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,e.exports=s,s.prototype.setAngle=function(t){this._angle=t,this._angleTarget=t,this.updatePosition()},s.prototype.moveToAngle=function(t){this._angleTarget=t,this._timeline&&this._timeline.kill(),this._timeline=new TimelineMax({onUpdateScope:this,onUpdate:function(){this.updatePosition()}}),this._timeline.to(this,.5,{_angle:this._angleTarget,ease:Quad.easeOut},0)},s.prototype.updatePosition=function(){var t=400,e=.25;this.x=Math.cos(this._angle)*t,this.y=Math.sin(this._angle)*t*e;var t=(Math.sin(this._angle)+1)/2;this.scale.set(.4+.4*t);var i=.25+.75*t;this._sprite.tint=(Math.round(255*i)<<16)+(Math.round(255*i)<<8)+Math.round(255*i),this._platform.tint=(Math.round(255*i)<<16)+(Math.round(255*i)<<8)+Math.round(255*i)},Object.defineProperty(s.prototype,"id",{get:function(){return this._id}}),Object.defineProperty(s.prototype,"angle",{get:function(){return this._angleTarget}})},{"../Common":8,"../Utils":11}],35:[function(t,e,i){"use strict";function s(t){PIXI.Container.call(this),this._scene=t,this.init()}var o=t("../Common"),n=t("../Utils");s.prototype=Object.create(PIXI.Container.prototype),s.prototype.constructor=s,e.exports=s,s.prototype.init=function(){var t=o.copy.SCORE[o.language];t.live?this._scoreText=new PIXI.Text("",{fontFamily:o.liveFont,fontSize:"48px",fill:16777215,align:"center",stroke:0,strokeThickness:6,padding:20,lineJoin:"round"}):this._scoreText=new PIXI.extras.BitmapText("",{font:"48px Gumball 8bit THICK",tint:16777215,align:"center"}),this._scoreText.anchor.set(.5),this._scoreText.x=o.STAGE_WIDTH/2+t.offset.x,this._scoreText.y=60+t.offset.y,this._scoreText.scale.set(t.scale),this._scoreText.textFormat=t.text,this._scoreText.value=0,this._scoreText.text=this._scoreText.textFormat.replace("{value}",0),this.addChild(this._scoreText);var t=o.copy.RECORD[o.language];t.live?this._recordText=new PIXI.Text("",{fontFamily:o.liveFont,fontSize:"24px",fill:16777215,align:"center",stroke:0,strokeThickness:6,padding:20,lineJoin:"round"}):this._recordText=new PIXI.extras.BitmapText("",{font:"24px Gumball 8bit THICK",tint:16777215,align:"center"}),this._recordText.anchor.set(.5),this._recordText.x=o.STAGE_WIDTH/2+t.offset.x,this._recordText.y=110+t.offset.y,this._recordText.scale.set(t.scale),this._recordText.textFormat=t.text,this._recordText.visible=0!=o.savedData.bestScore,this._recordText.text=this._recordText.textFormat.replace("{value}",o.savedData.bestScore),this.addChild(this._recordText),this._powerupContainer=new PIXI.Container,this.addChild(this._powerupContainer),this._powerups=[],this._wind=new PIXI.Container,this._wind.y=0,this._powerupContainer.addChild(this._wind),this._windIcon=new PIXI.Sprite(o.assets.getTexture("icon_wind")),this._windIcon.anchor.set(.5),this._windIcon.y=-10,this._wind.addChild(this._windIcon),this._windText=new PIXI.extras.BitmapText("0",{font:"30px Gumball 8bit THICK",tint:16777215,align:"left"}),this._windText.anchor.set(.5),this._windText.x=16,this._windText.y=50,this._wind.addChild(this._windText);var e=o.assets.getTexture("icon_next_2");this._windArrow=new PIXI.Sprite(e),this._windArrow.anchor.set(.5),this._windArrow.scale.set(.35),this._windArrow.x=-16,this._windArrow.y=this._windText.y+2,this._wind.addChild(this._windArrow),this.updateWind(0),this._multiplier=new PIXI.Container,this._multiplier.y=400,this._multiplier.visible=!1,this._powerupContainer.addChild(this._multiplier);var i=new PIXI.Sprite(o.assets.getTexture("icon_box"));i.anchor.set(.5),this._multiplier.addChild(i),this._multiplier.string=new PIXI.extras.BitmapText("0x",{font:"36px Gumball 8bit THICK",tint:16777215,align:"left"}),this._multiplier.string.anchor.set(.5),this._multiplier.string.y=-5,this._multiplier.addChild(this._multiplier.string),this._powerups.boot=new PIXI.Container,this._powerups.boot.y=200,this._powerups.boot.visible=!1,this._powerupContainer.addChild(this._powerups.boot);var i=new PIXI.Sprite(o.assets.getTexture("icon_box"));i.anchor.set(.5),this._powerups.boot.addChild(i);var s=new PIXI.Sprite(o.assets.getTexture("icon_boot"));s.anchor.set(.5),s.x=5,s.scale.set(.9),this._powerups.boot.addChild(s),this._powerups.boot.string=new PIXI.extras.BitmapText("+1",{font:"36px Gumball 8bit THICK",tint:16777215,align:"left"}),this._powerups.boot.string.anchor.set(.5),this._powerups.boot.string.y=25,this._powerups.life=new PIXI.Container,this._powerups.life.y=300,this._powerups.life.visible=!1,this._powerupContainer.addChild(this._powerups.life);var i=new PIXI.Sprite(o.assets.getTexture("icon_box"));i.anchor.set(.5),this._powerups.life.addChild(i);var s=new PIXI.Sprite(o.assets.getTexture("icon_floppydisk"));s.anchor.set(.5),this._powerups.life.addChild(s)},s.prototype.updateScore=function(t){if(t!=this._scoreText.value){this._scoreText.value<=o.savedData.bestScore&&t>o.savedData.bestScore&&o.audio.playSound("sfx_new_best_00"),TweenMax.killTweensOf(this._scoreText);var e=t-this._scoreText.value;if(e<=1)this._scoreText.value=t,this._scoreText.text=this._scoreText.textFormat.replace("{value}",t),this._scoreText.value>o.savedData.bestScore&&(this._recordText.text=this._recordText.textFormat.replace("{value}",this._scoreText.value));else{var i=Math.min(.05*e,.5);TweenMax.to(this._scoreText,i,{value:t,ease:Sine.easeOut,onUpdateScope:this,onUpdate:function(){this._scoreText.text=this._scoreText.textFormat.replace("{value}",Math.floor(this._scoreText.value)),this._scoreText.value>o.savedData.bestScore&&(this._recordText.text=this._recordText.textFormat.replace("{value}",Math.floor(this._scoreText.value)))}},0)}}},s.prototype.updateWind=function(t){this._windText.text=Math.abs(t),this._windArrow.scale.x=Math.abs(this._windArrow.scale.x)*Math.sign(t||1);var e=0!=Math.sign(t)?Math.sign(t):1,i=e*(5-Math.abs(t))*15*PIXI.DEG_TO_RAD;TweenMax.killTweensOf(this._windIcon),TweenMax.killTweensOf(this._windIcon.scale),TweenMax.to(this._windIcon,.5,{rotation:i,ease:Sine.easeOut}),TweenMax.to(this._windIcon.scale,.5,{x:e,ease:Sine.easeInOut}),0!=t&&TweenMax.to(this._windIcon,1/Math.abs(t),{rotation:i+15*PIXI.DEG_TO_RAD,ease:Sine.easeInOut,yoyo:!0,repeat:-1,delay:.5})},s.prototype.showPowerup=function(t,e){this._powerups[t]&&(this._powerups[t].visible=!0,e&&this._powerups[t].string&&(this._powerups[t].string.text="+"+e))},s.prototype.hidePowerup=function(t,e){this._powerups[t]&&(e>0?this.showPowerup(t,e):this._powerups[t].visible=!1)},s.prototype.showMultiplier=function(t){this._multiplier.visible=!0,this._multiplier.string.text=t},s.prototype.hideMultiplier=function(){this._multiplier.visible=!1},s.prototype.resize=function(){this._powerupContainer.x=n.getFirstButtonPositionLeft()+50,this._powerupContainer.y=100}},{"../Common":8,"../Utils":11}],36:[function(t,e,i){"use strict";function s(t,e,i){p3.Button.call(this,t),this._onIconTexture=e,this._offIconTexture=i}var o=t("../Common");e.exports=s,s.prototype=Object.create(p3.Button.prototype),s.prototype.constructor=s,s.prototype.onMouseDown=function(t){this._enabled=!this._enabled,this._currentIconTexture=this.isEnabled()?this._offIconTexture:this._onIconTexture,this._icon.texture=this._currentIconTexture,o.audio.mute(!o.audio.isMute),p3.Button.prototype.onMouseDown.call(this,t)},s.prototype.isEnabled=function(){return!!p3.Button.audio&&!p3.Button.audio.isMute}},{"../Common":8}]},{},[24]);